<!DOCTYPE html>
<html lang="pt-BR" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Portal Auto Arremate® / Arremaq 3.0 com Ferramentas de IA Avançadas</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Sora:wght@400;600;700;800&family=Manrope:wght@400;500;600;700;800&family=IBM+Plex+Sans:wght@400;500;600;700;900&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
    <style>
        :root {
            --aa-green: #16B097;
            --aa-dark-blue: #1C2E42;
            --aa-light-gray: #AEB0B2;
            --aa-white: #FFFFFF;
            --aa-black: #000000;
            --aa-green-darker: #0F8A7E;
            --aa-green-lighter: #D2F3EC;
            --aa-green-pastel: #e0f7fa;
            --aa-dark-blue-lighter: #2C4A6B;

            --arremaq-orange: #FF8C00;
            --arremaq-orange-lighter: #FFD073;
            --arremaq-orange-pastel: #fff3e0;
            --arremaq-orange-darker: #CC7000;

            --font-headings-cover: 'IBM Plex Sans', sans-serif;
            --font-body-cover: 'Inter', sans-serif;

            --font-primary-portal: 'Manrope', sans-serif;
            --font-headings-portal: 'Sora', sans-serif;

            --brand-primary-accent-portal: var(--aa-green);
            --brand-primary-accent-darker-portal: var(--aa-green-darker);
            --brand-primary-accent-lighter-portal: var(--aa-green-lighter);
            --brand-secondary-accent-portal: var(--arremaq-orange);
            --brand-tertiary-accent-portal: var(--aa-dark-blue);

            --bg-main-light: #F7FAFC;
            --bg-main-dark: #101419;

            --bg-content-light-portal: var(--aa-white);
            --bg-content-dark-portal: #1A202C;
            --bg-interactive-light-portal: #EDF2F7;
            --bg-interactive-dark-portal: #2D3748;
            --bg-ai-tool-light: #E6FFFA; 
            --bg-ai-tool-dark: #1C2A3A;   


            --text-headings-light-portal: var(--aa-dark-blue);
            --text-headings-dark-portal: #E2E8F0;
            --text-body-light-portal: #4A5568;
            --text-body-dark-portal: #CBD5E0;
            --text-on-accent-portal: var(--aa-white);
            --text-muted-light-portal: #718096;
            --text-muted-dark-portal: #A0AEC0;

            --border-color-light-portal: #E2E8F0;
            --border-color-dark-portal: #4A5568;

            --shadow-color-light-portal: rgba(22, 176, 151, 0.1);
            --shadow-color-dark-portal: rgba(0, 0, 0, 0.3);

            --shadow-sm: 0 1px 3px 0 var(--shadow-color-light-portal), 0 1px 2px 0 var(--shadow-color-light-portal);
            --shadow-md: 0 4px 6px -1px rgba(0,0,0,0.05), 0 2px 4px -1px rgba(0,0,0,0.02);
            --shadow-lg: 0 10px 15px -3px rgba(0,0,0,0.05), 0 4px 6px -2px rgba(0,0,0,0.03);
            --shadow-xl: 0 20px 25px -5px var(--shadow-color-light-portal), 0 10px 10px -5px var(--shadow-color-light-portal);
            --shadow-primary-glow-light: 0 0 20px rgba(22, 176, 151, 0.25);
            --shadow-primary-glow-dark: 0 0 20px rgba(22, 176, 151, 0.45);

            --radius-lg: 0.75rem;
            --radius-round: 50px;
            --radius-card-portal: 1.25rem;
            --radius-button-portal: 0.75rem;

            --transition-main: .3s cubic-bezier(.4,0,.2,1);
        }

        html[data-theme='dark'] :root {
            --shadow-sm: 0 1px 3px 0 var(--shadow-color-dark-portal), 0 1px 2px 0 var(--shadow-color-dark-portal);
            --shadow-md: 0 4px 6px -1px rgba(0,0,0,0.2), 0 2px 4px -1px rgba(0,0,0,0.15);
            --shadow-lg: 0 10px 15px -3px rgba(0,0,0,0.3), 0 4px 6px -2px rgba(0,0,0,0.2);
            --shadow-xl: 0 20px 25px -5px var(--shadow-color-dark-portal), 0 10px 10px -5px var(--shadow-color-dark-portal);
            --brand-secondary-accent-portal: var(--arremaq-orange-lighter);
        }

        html {
            scroll-behavior: smooth;
            font-family: var(--font-body-cover);
            background: var(--bg-main-light);
            color: var(--aa-dark-blue);
            font-size: 16px;
        }
        html[data-theme='dark'] {
            background: var(--bg-main-dark);
            color: #E2E8F0;
        }
        body {
            margin: 0;
            font-family: var(--font-body-cover);
            overflow-x: hidden;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }
        main {
            flex-grow: 1;
            width: 100%;
            padding-top: 0;
        }

        .capa-section {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: clamp(1.5rem, 6vw, 3rem) clamp(1rem, 5vw, 2rem);
            text-align: center;
            position: relative;
            border-radius: 0;
            box-shadow: none;
            width: 100%;
            max-width: none;
            margin: 0;
            background: linear-gradient(100deg, var(--aa-green-pastel) 0%, var(--aa-green-lighter) 48%, var(--arremaq-orange-lighter) 52%, var(--arremaq-orange-pastel) 100%);
        }
        html[data-theme='dark'] .capa-section {
            background: linear-gradient(100deg, #17575c 0%, var(--aa-dark-blue) 48%, var(--arremaq-orange-darker) 52%, #6b3e00 100%);
        }
        .logos-container { display: flex; justify-content: center; align-items: center; gap: 1.5rem; margin-bottom: 1.5rem; }
        .playbook-logo {
            width: 180px; max-width: 45%; height: auto; display: block;
            filter: drop-shadow(0 0.5rem 1rem rgba(0, 0, 0, 0.1));
            animation: logo-float 3s ease-in-out infinite alternate;
        }
        html[data-theme='dark'] .playbook-logo { filter: drop-shadow(0 0.5rem 1rem rgba(0, 0, 0, 0.3)); }
        @keyframes logo-float { 0% {transform: translateY(0px);} 100%{transform: translateY(-6px);} }

        .capa-title {
            font-family: var(--font-headings-cover);
            font-weight: 700;
            text-transform: uppercase;
            text-align: center;
            margin-top: 0.5em;
            margin-bottom: 0.8em;
            font-size: clamp(1.7rem, 4.2vw, 2.5rem);
            text-shadow: 0 1px 3px rgba(22, 176, 151, 0.2);
            line-height: 1.25;
        }
        .capa-title .title-autoarremate-part { color: var(--aa-green); }
        .capa-title .title-arremaq-part { color: var(--arremaq-orange); }
        html[data-theme='dark'] .capa-title .title-autoarremate-part { color: var(--aa-green-lighter); }
        html[data-theme='dark'] .capa-title .title-arremaq-part { color: var(--arremaq-orange-lighter); }

        .capa-title .year-highlight {
            font-weight: 900;
        }
        .capa-title sup {
            font-size:0.75rem; font-weight:600;
            color:var(--aa-green-darker);
            vertical-align: super; margin-left: 0.1em;
        }
        html[data-theme='dark'] .capa-title sup {
            color: var(--aa-green);
        }
        .frase-destaque {
            font-family: var(--font-headings-cover); color: var(--aa-dark-blue);
            font-size: clamp(0.9rem, 2vw, 1.2rem); font-weight: 600;
            background: rgba(255, 255, 255, 0.9); border-radius: var(--radius-lg);
            box-shadow: var(--shadow-md); padding: 0.4em 1.5em 0.45em 1.3em;
            margin-bottom: 1.5rem; margin-top: 0.5em; display: inline-block;
            border-left: 0.3rem solid var(--aa-green);
            text-shadow: 1px 1px 2px rgba(255, 255, 255, 0.4);
            transition: all var(--transition-main); text-transform: none;
        }
        .frase-destaque:hover, .frase-destaque:focus-visible {
            transform: translateY(-3px) scale(1.02); box-shadow: var(--shadow-lg);
            background: var(--aa-white); color: var(--aa-green-darker); outline: none;
        }
        html[data-theme='dark'] .frase-destaque {
            background: rgba(28, 46, 66, 0.9); color: var(--aa-green-lighter);
            text-shadow: 0 1px 3px rgba(0,0,0,0.5); border-left-color: var(--aa-green-lighter);
        }
        html[data-theme='dark'] .frase-destaque:hover, html[data-theme='dark'] .frase-destaque:focus-visible {
            background: var(--aa-dark-blue-lighter); color: var(--aa-white);
        }
        .capa-criado {
            font-family: var(--font-body-cover); font-size: 0.85rem; color: var(--aa-dark-blue);
            opacity: 0.9; margin-top: 1.2rem; margin-bottom: 1.2rem;
            font-weight: 500; text-transform: none;
        }
        .capa-criado strong {
            font-family: var(--font-body-cover); color: var(--aa-dark-blue);
            font-size: 1.1em; font-style: normal; margin-left: 0.2em; font-weight: 700;
        }
        html[data-theme='dark'] .capa-criado { color: #E2E8F0; opacity: 0.8; }
        html[data-theme='dark'] .capa-criado strong { color: var(--aa-green-lighter); }

        .btn-iniciar {
            display: inline-flex; align-items: center; gap: 0.8em;
            font-family: var(--font-headings-cover); font-size: 1rem; font-weight: 600;
            padding: 0.7em 1.8em; background: var(--aa-green); color: var(--aa-white);
            border: none; border-radius: var(--radius-round); cursor: pointer;
            box-shadow: var(--shadow-md), 0 2px 4px -2px var(--aa-green-darker) inset;
            transition: all var(--transition-main); outline: none;
            margin-top: 1.5em; margin-bottom: 1.5em; text-transform: uppercase;
            letter-spacing: 0.05em; position: relative; overflow: hidden;
        }
        .btn-iniciar::before {
            content: ""; position: absolute; top: 0; left: -100%;
            width: 100%; height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            transition: left 0.5s ease-out;
        }
        .btn-iniciar:hover::before { left: 100%; }
        .btn-iniciar:hover, .btn-iniciar:focus-visible {
            background: var(--aa-green-darker); transform: scale(1.05) translateY(-3px);
            box-shadow: var(--shadow-lg), 0 2px 4px -2px var(--aa-green) inset, var(--shadow-primary-glow-light);
        }
        html[data-theme='dark'] .btn-iniciar {
            color: var(--aa-white);
            box-shadow: var(--shadow-md), 0 2px 4px -2px var(--aa-green) inset;
        }
        html[data-theme='dark'] .btn-iniciar:hover, html[data-theme='dark'] .btn-iniciar:focus-visible {
            background: var(--aa-green-lighter); color: var(--aa-dark-blue);
            box-shadow: var(--shadow-lg), 0 2px 4px -2px var(--aa-green-darker) inset, var(--shadow-primary-glow-dark);
        }
        .btn-iniciar svg { width: 1.4em; height: 1.4em; transition: transform 0.3s ease; }
        .btn-iniciar:hover svg { transform: rotate(10deg) scale(1.1); }

        .capa-social-links {
            margin-top: 1.5rem;
            display: flex;
            gap: 1.25rem;
            justify-content: center;
        }
        .capa-social-links a {
            color: var(--aa-dark-blue);
            font-size: 1.75rem;
            transition: color var(--transition-main), transform var(--transition-main);
        }
        .capa-social-links a:hover {
            color: var(--aa-green);
            transform: scale(1.15);
        }
        html[data-theme='dark'] .capa-social-links a {
            color: var(--aa-green-lighter);
        }
        html[data-theme='dark'] .capa-social-links a:hover {
            color: var(--aa-white);
        }

        .global-header {
            background-color: var(--bg-content-light-portal);
            box-shadow: var(--shadow-md);
            padding: 1rem 1.5rem;
            position: sticky; top: 0; z-index: 1000;
            transition: background-color var(--transition-main);
        }
        html[data-theme='dark'] .global-header {
            background-color: var(--bg-content-dark-portal);
        }
        .header-logo {
            font-family: var(--font-headings-portal); font-weight: 800;
            font-size: 1.4rem;
            letter-spacing: -0.5px;
        }
        .header-logo .title-autoarremate-part { color: var(--brand-primary-accent-portal); }
        .header-logo .title-arremaq-part { color: var(--brand-secondary-accent-portal); }
        html[data-theme='dark'] .header-logo .title-autoarremate-part { color: var(--brand-primary-accent-lighter-portal); }
        html[data-theme='dark'] .header-logo .title-arremaq-part { color: var(--arremaq-orange-lighter); }

        .dark-toggle, .voice-toggle {
            background-color: var(--bg-interactive-light-portal);
            border: 1px solid var(--border-color-light-portal);
            color: var(--text-muted-light-portal);
            padding: 0.6rem; border-radius: 50%;
            transition: all var(--transition-main);
            display: flex; align-items: center; justify-content: center;
            cursor: pointer;
        }
        .dark-toggle:hover, .voice-toggle:hover {
            transform: scale(1.1) rotate(15deg);
            color: var(--brand-primary-accent-portal);
            border-color: var(--brand-primary-accent-portal);
        }
        .voice-toggle.listening {
            color: var(--aa-green-darker);
            border-color: var(--aa-green-darker);
            animation: pulse 1.5s infinite;
        }
        html[data-theme='dark'] .dark-toggle, html[data-theme='dark'] .voice-toggle {
            background-color: var(--bg-interactive-dark-portal);
            border-color: var(--border-color-dark-portal);
            color: var(--text-muted-dark-portal);
        }
        html[data-theme='dark'] .dark-toggle:hover, html[data-theme='dark'] .voice-toggle:hover {
            color: var(--brand-primary-accent-lighter-portal);
            border-color: var(--brand-primary-accent-lighter-portal);
        }
         html[data-theme='dark'] .voice-toggle.listening {
            color: var(--aa-green-lighter);
            border-color: var(--aa-green-lighter);
        }
        .dark-toggle svg, .voice-toggle svg { width: 1.25rem; height: 1.25rem; }

        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(22, 176, 151, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(22, 176, 151, 0); }
            100% { box-shadow: 0 0 0 0 rgba(22, 176, 151, 0); }
        }


        #portal-cards-section .page-title {
            font-family: var(--font-headings-portal);
            font-weight: 800;
            font-size: clamp(2rem, 4.5vw, 2.8rem);
            margin-bottom: 0.75rem;
            line-height: 1.25;
        }
        #portal-cards-section .page-title .title-autoarremate-part { color: var(--aa-green); }
        #portal-cards-section .page-title .title-arremaq-part { color: var(--arremaq-orange); }
        html[data-theme='dark'] #portal-cards-section .page-title .title-autoarremate-part { color: var(--aa-green-lighter); }
        html[data-theme='dark'] #portal-cards-section .page-title .title-arremaq-part { color: var(--arremaq-orange-lighter); }

        #portal-cards-section .page-subtitle {
            font-family: var(--font-primary-portal);
            font-size: 1.1rem;
            color: var(--aa-dark-blue);
            max-width: 60ch;
            margin-bottom: 2.5rem;
            opacity: 0.9;
        }
        html[data-theme='dark'] #portal-cards-section .page-subtitle { color: var(--aa-light-gray); }

        #portal-cards-section,
        #playbook-content-section,
        #training-center-content-section,
        #playbook-sec-0-content,
        #ai-tool-interaction-section { 
            padding: 2rem 1rem;
            background: linear-gradient(100deg, var(--aa-green-pastel) 0%, var(--aa-green-lighter) 48%, var(--arremaq-orange-lighter) 52%, var(--arremaq-orange-pastel) 100%);
        }
        html[data-theme='dark'] #portal-cards-section,
        html[data-theme='dark'] #playbook-content-section,
        html[data-theme='dark'] #training-center-content-section,
        html[data-theme='dark'] #playbook-sec-0-content,
        html[data-theme='dark'] #ai-tool-interaction-section { 
            background: linear-gradient(100deg, #17575c 0%, var(--aa-dark-blue) 48%, var(--arremaq-orange-darker) 52%, #6b3e00 100%);
        }

        #ai-tool-interaction-section .container {
            background-color: var(--bg-ai-tool-light);
            border-radius: var(--radius-card-portal);
            padding: 2rem;
            box-shadow: var(--shadow-xl);
        }
        html[data-theme='dark'] #ai-tool-interaction-section .container {
            background-color: var(--bg-ai-tool-dark);
        }
        #ai-tool-interaction-section .ai-tool-title {
            font-family: var(--font-headings-portal);
            font-size: clamp(1.6rem, 3.5vw, 2.2rem);
            color: var(--brand-primary-accent-portal);
            margin-bottom: 0.5rem;
        }
        html[data-theme='dark'] #ai-tool-interaction-section .ai-tool-title {
            color: var(--brand-primary-accent-lighter-portal);
        }
        #ai-tool-interaction-section .ai-tool-description {
            font-family: var(--font-primary-portal);
            font-size: 1rem;
            color: var(--text-body-light-portal);
            margin-bottom: 1.5rem;
            max-width: 70ch;
            margin-left: auto;
            margin-right: auto;
        }
        html[data-theme='dark'] #ai-tool-interaction-section .ai-tool-description {
            color: var(--text-body-dark-portal);
        }
        #ai-tool-interaction-section .input-field-label {
            display: block;
            font-family: var(--font-primary-portal);
            font-weight: 600;
            color: var(--text-headings-light-portal);
            margin-bottom: 0.5rem;
            text-align: left;
        }
        html[data-theme='dark'] #ai-tool-interaction-section .input-field-label {
            color: var(--text-headings-dark-portal);
        }
        #ai-tool-interaction-section .input-field {
            width: 100%;
            padding: 0.75rem 1rem;
            border-radius: var(--radius-button-portal);
            border: 1px solid var(--border-color-light-portal);
            background-color: var(--aa-white);
            color: var(--text-body-light-portal);
            font-family: var(--font-primary-portal);
            margin-bottom: 1rem;
            transition: border-color var(--transition-main), box-shadow var(--transition-main);
        }
        #ai-tool-interaction-section .input-field:focus {
            outline: none;
            border-color: var(--brand-primary-accent-portal);
            box-shadow: 0 0 0 3px var(--shadow-color-light-portal);
        }
        html[data-theme='dark'] #ai-tool-interaction-section .input-field {
            background-color: var(--bg-interactive-dark-portal);
            border-color: var(--border-color-dark-portal);
            color: var(--text-body-dark-portal);
        }
        html[data-theme='dark'] #ai-tool-interaction-section .input-field:focus {
            border-color: var(--brand-primary-accent-lighter-portal);
            box-shadow: 0 0 0 3px rgba(22, 176, 151, 0.3);
        }
        #ai-tool-interaction-section .btn-ai-action { /* Classe genérica para botões de ação IA */
            background-color: var(--brand-primary-accent-portal);
            color: var(--text-on-accent-portal);
            padding: 0.75rem 1.5rem;
            font-family: var(--font-headings-cover);
            font-weight: 600;
            border-radius: var(--radius-button-portal);
            transition: background-color var(--transition-main);
            cursor: pointer;
        }
        #ai-tool-interaction-section .btn-ai-action:hover {
            background-color: var(--brand-primary-accent-darker-portal);
        }
         #ai-tool-interaction-section .btn-ai-action:disabled {
            background-color: var(--aa-light-gray);
            cursor: not-allowed;
        }
        html[data-theme='dark'] #ai-tool-interaction-section .btn-ai-action {
             background-color: var(--brand-primary-accent-lighter-portal);
             color: var(--aa-dark-blue);
        }
        html[data-theme='dark'] #ai-tool-interaction-section .btn-ai-action:hover {
            background-color: var(--aa-green);
        }
        html[data-theme='dark'] #ai-tool-interaction-section .btn-ai-action:disabled {
            background-color: var(--aa-light-gray);
            color: var(--text-muted-dark-portal);
        }


        #ai-tool-interaction-section #aiToolOutput {
            margin-top: 1.5rem;
            padding: 1rem;
            border-radius: var(--radius-lg);
            background-color: var(--bg-interactive-light-portal);
            color: var(--text-body-light-portal);
            text-align: left;
            white-space: pre-wrap; 
            min-height: 100px;
            border: 1px solid var(--border-color-light-portal);
        }
        html[data-theme='dark'] #ai-tool-interaction-section #aiToolOutput {
            background-color: var(--bg-interactive-dark-portal);
            color: var(--text-body-dark-portal);
            border-color: var(--border-color-dark-portal);
        }
        #ai-tool-interaction-section #roleplayLog {
            margin-top: 1.5rem;
            padding: 1rem;
            border-radius: var(--radius-lg);
            background-color: var(--bg-interactive-light-portal);
            color: var(--text-body-light-portal);
            text-align: left;
            white-space: pre-wrap;
            min-height: 150px;
            max-height: 400px;
            overflow-y: auto;
            border: 1px solid var(--border-color-light-portal);
        }
        html[data-theme='dark'] #ai-tool-interaction-section #roleplayLog {
             background-color: var(--bg-interactive-dark-portal);
            color: var(--text-body-dark-portal);
            border-color: var(--border-color-dark-portal);
        }
        #ai-tool-interaction-section #roleplayLog .user-message { font-weight: bold; color: var(--aa-green-darker); }
        #ai-tool-interaction-section #roleplayLog .ai-message { color: var(--arremaq-orange-darker); }
        html[data-theme='dark'] #ai-tool-interaction-section #roleplayLog .user-message { color: var(--aa-green-lighter); }
        html[data-theme='dark'] #ai-tool-interaction-section #roleplayLog .ai-message { color: var(--arremaq-orange-lighter); }
        #saveFeedbackMessage {
            margin-top: 0.5rem;
            font-size: 0.875rem;
            min-height: 1.25rem; /* Para evitar que o layout salte */
        }
        .feedback-success { color: var(--aa-green-darker); }
        .feedback-error { color: var(--arremaq-orange-darker); }
        html[data-theme='dark'] .feedback-success { color: var(--aa-green-lighter); }
        html[data-theme='dark'] .feedback-error { color: var(--arremaq-orange-lighter); }



        #portal-cards-section > .container,
        #playbook-content-section > .container,
        #training-center-content-section > .container,
        #playbook-sec-0-content > .container {
            background-color: transparent;
        }

        .section-title-main {
            font-family: var(--font-headings-portal);
            font-size: clamp(1.8rem, 4vw, 2.5rem);
            margin-top: 1.5rem;
            margin-bottom: 2rem;
            padding-bottom: 0.6rem;
            border-bottom: 2px solid var(--border-color-light-portal);
            color: var(--text-headings-light-portal);
        }
        html[data-theme='dark'] .section-title-main {
            border-bottom-color: var(--border-color-dark-portal);
            color: var(--text-headings-dark-portal);
        }
        .section-title-main i {
            margin-right: 0.6rem;
            font-size: 0.85em;
        }
        #playbook-content-section .section-title-main i { color: var(--brand-secondary-accent-portal); }
        html[data-theme='dark'] #playbook-content-section .section-title-main i { color: var(--arremaq-orange-lighter); }
        #training-center-content-section .section-title-main i { color: var(--brand-primary-accent-portal); }
         html[data-theme='dark'] #training-center-content-section .section-title-main i { color: var(--aa-green-lighter); }

        @keyframes sway {
            0% { transform: rotate(0deg); }
            25% { transform: rotate(1deg); }
            75% { transform: rotate(-1deg); }
            100% { transform: rotate(0deg); }
        }
        .portal-card {
            background-color: var(--bg-content-light-portal);
            border-radius: var(--radius-round);
            padding: 2rem 1.5rem;
            box-shadow: var(--shadow-lg);
            transition: all var(--transition-main);
            border: 2px solid transparent;
            cursor: pointer;
            animation: sway 7s ease-in-out infinite;
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
        }
        .portal-card:nth-child(odd) { animation-delay: -3.5s; }

        .portal-card:hover {
            transform: translateY(-7px) scale(1.02);
            box-shadow: var(--shadow-xl);
            border-color: var(--brand-primary-accent-portal);
            animation-play-state: paused;
        }
        html[data-theme='dark'] .portal-card {
            background-color: var(--bg-content-dark-portal);
        }
        html[data-theme='dark'] .portal-card:hover {
            border-color: var(--brand-primary-accent-lighter-portal);
        }
        .portal-card-icon {
            font-size: 3.8rem;
            margin-bottom: 1.2rem;
        }
        #openPlaybookBtn .portal-card-icon { color: var(--brand-secondary-accent-portal); }
        #openTrainingCenterBtn .portal-card-icon { color: var(--brand-primary-accent-portal); }

        html[data-theme='dark'] #openPlaybookBtn .portal-card-icon { color: var(--arremaq-orange-lighter); }
        html[data-theme='dark'] #openTrainingCenterBtn .portal-card-icon { color: var(--aa-green-lighter); }

        .portal-card-title {
            font-family: var(--font-headings-portal);
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 0.6rem;
            color: var(--text-headings-light-portal);
        }
        html[data-theme='dark'] .portal-card-title {
            color: var(--text-headings-dark-portal);
        }
        .portal-card-description {
            font-family: var(--font-primary-portal);
            font-size: 0.9rem;
            color: var(--text-body-light-portal);
            line-height: 1.5;
        }
        html[data-theme='dark'] .portal-card-description {
            color: var(--text-body-dark-portal);
        }

        .index-item-card {
            background-color: var(--bg-interactive-light-portal);
            border-radius: 30px;
            padding: 1.25rem 1rem;
            box-shadow: var(--shadow-md);
            transition: all var(--transition-main);
            border-left: 4px solid transparent;
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
        }
        .index-item-card:hover {
            transform: translateX(4px) scale(1.01);
            box-shadow: var(--shadow-lg);
            border-left-color: var(--arremaq-orange);
        }
        html[data-theme='dark'] .index-item-card {
            background-color: var(--bg-interactive-dark-portal);
        }
        html[data-theme='dark'] .index-item-card:hover {
            border-left-color: var(--arremaq-orange-lighter);
        }
        .index-item-emoji {
            font-size: 2.8rem;
            margin-bottom: 0.85rem;
            color: var(--arremaq-orange);
            line-height: 1;
        }
        html[data-theme='dark'] .index-item-emoji {
            color: var(--arremaq-orange-lighter);
        }
        .index-item-title {
            font-family: var(--font-headings-portal);
            font-weight: 600;
            font-size: 1rem;
            color: var(--text-headings-light-portal);
            margin-bottom: 0.3rem;
        }
        html[data-theme='dark'] .index-item-title {
            color: var(--text-headings-dark-portal);
        }
        .index-item-title a { text-decoration: none; color: inherit; }
        .index-item-title a:hover {
            color: var(--brand-primary-accent-portal);
            text-decoration: underline;
        }
        html[data-theme='dark'] .index-item-title a:hover {
            color: var(--brand-primary-accent-lighter-portal);
        }
        .index-item-sub {
            font-family: var(--font-primary-portal);
            font-size: 0.8rem;
            color: var(--text-muted-light-portal);
            padding-left: 0;
        }
        html[data-theme='dark'] .index-item-sub {
            color: var(--text-muted-dark-portal);
        }
        .index-item-sub .sentence-emoji { margin-right: 0.3em; }

        .btn-back {
            display: inline-flex; align-items: center;
            font-family: var(--font-headings-portal); font-weight: 600;
            padding: 0.5rem 1rem;
            border-radius: var(--radius-button-portal);
            text-decoration: none; transition: all var(--transition-main);
            border: 2px solid var(--border-color-light-portal);
            background-color: var(--bg-interactive-light-portal);
            color: var(--text-body-light-portal);
            font-size: 0.85rem;
            margin-bottom: 1.5rem;
        }
        .btn-back:hover {
            background-color: var(--border-color-light-portal);
            border-color: var(--text-muted-light-portal);
            transform: translateX(-2px);
        }
        html[data-theme='dark'] .btn-back {
            background-color: var(--bg-interactive-dark-portal);
            color: var(--text-body-dark-portal);
            border-color: var(--border-color-dark-portal);
        }
        html[data-theme='dark'] .btn-back:hover {
            background-color: var(--border-color-dark-portal);
            border-color: var(--text-muted-dark-portal);
        }
        .btn-back i { margin-right: 0.4rem; }

        .btn-back-to-cover {
            margin-top: 2rem;
            border-color: var(--aa-green);
            color: var(--aa-green-darker);
        }
        html[data-theme='dark'] .btn-back-to-cover {
            border-color: var(--aa-green-lighter);
            color: var(--aa-green-lighter);
        }
        .btn-back-to-cover:hover {
             background-color: var(--aa-green-lighter);
             border-color: var(--aa-green);
        }
        html[data-theme='dark'] .btn-back-to-cover:hover {
             background-color: var(--aa-green-darker);
             border-color: var(--aa-green-lighter);
        }

        .training-card {
            background-color: var(--bg-content-light-portal);
            border-radius: 30px;
            box-shadow: var(--shadow-lg);
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            cursor: pointer; 
        }
        html[data-theme='dark'] .training-card { background-color: var(--bg-content-dark-portal); }
        html[data-theme='dark'] .training-card:hover { border-color: var(--brand-primary-accent-lighter-portal); }

        .card-icon-wrapper {
            color: var(--aa-green);
            width: 6rem; height: 6rem;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            background-color: var(--aa-green-lighter);
        }
        .card-icon-wrapper i {
            font-size: 3.2rem;
        }
        html[data-theme='dark'] .card-icon-wrapper {
            color: var(--aa-green-lighter);
            background-color: var(--aa-green-darker);
        }
        .card-icon-wrapper .fa-gem { 
             color: #7c3aed;
        }
         html[data-theme='dark'] .card-icon-wrapper .fa-gem {
            color: #a78bfa;
        }


        .training-card .card-title {
            font-family: var(--font-headings-portal);
            font-size: 1.4rem;
            color: var(--aa-green);
            margin-bottom: 0.5rem;
        }
        html[data-theme='dark'] .training-card .card-title { color: var(--aa-green-lighter); }

        .training-card .card-description {
            font-family: var(--font-primary-portal);
            color: var(--text-body-light-portal);
            font-size: 0.9rem;
            line-height: 1.5;
            margin-bottom: 1rem;
            flex-grow: 1; 
        }
        html[data-theme='dark'] .training-card .card-description { color: var(--text-body-dark-portal); }

        .training-card .card-button { 
            font-family: var(--font-primary-portal);
            border-radius: var(--radius-button-portal);
            background-color: transparent; 
            color: var(--arremaq-orange);
            border: none; 
            margin-top: auto;
            padding: 0.6rem 1.2rem;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            transition: all var(--transition-main);
            width: 100%; 
            justify-content: center;
        }
         .training-card:hover .card-button { 
            color: var(--arremaq-orange-darker);
        }
        html[data-theme='dark'] .training-card .card-button {
            color: var(--arremaq-orange-lighter);
        }
        html[data-theme='dark'] .training-card:hover .card-button {
            color: var(--arremaq-orange);
        }


        #playbook-sec-0-content .playbook-inner-content { }

        html[data-theme='light'] #playbook-sec-0-content .playbook-inner-content {
            background-color: var(--bg-content-light-portal);
            color: var(--text-body-light-portal);
        }
        html[data-theme='light'] #playbook-sec-0-content .playbook-inner-content .playbook-content-title {
            color: var(--brand-primary-accent-portal);
            border-bottom-color: var(--brand-primary-accent-lighter-portal);
        }
        html[data-theme='light'] #playbook-sec-0-content .playbook-inner-content h3 {
            color: var(--brand-secondary-accent-portal);
        }
        html[data-theme='light'] #playbook-sec-0-content .playbook-inner-content p strong {
            color: var(--brand-tertiary-accent-portal);
        }
        html[data-theme='light'] #playbook-sec-0-content .playbook-inner-content .valores-list strong {
             color: var(--text-headings-light-portal);
        }
        html[data-theme='light'] #playbook-sec-0-content .playbook-inner-content .valores-list .emoji {
            color: var(--aa-green);
        }


        html[data-theme='dark'] #playbook-sec-0-content .playbook-inner-content {
            background-color: var(--bg-content-dark-portal);
            color: var(--text-body-dark-portal);
        }
        html[data-theme='dark'] #playbook-sec-0-content .playbook-inner-content .playbook-content-title {
            color: var(--brand-primary-accent-lighter-portal);
            border-bottom-color: var(--brand-primary-accent-darker-portal);
        }
        html[data-theme='dark'] #playbook-sec-0-content .playbook-inner-content h3 {
            color: var(--arremaq-orange-lighter);
        }
        html[data-theme='dark'] #playbook-sec-0-content .playbook-inner-content p strong {
            color: var(--aa-green-lighter);
        }
        html[data-theme='dark'] #playbook-sec-0-content .playbook-inner-content .valores-list strong {
            color: var(--text-headings-dark-portal);
        }
        html[data-theme='dark'] #playbook-sec-0-content .playbook-inner-content .valores-list .emoji {
            color: var(--aa-green-lighter);
        }

        #playbook-sec-0-content .playbook-content-title {
            font-family: var(--font-headings-portal);
            font-size: clamp(1.7rem, 3.5vw, 2.2rem);
            text-transform: uppercase;
            text-align: center;
            margin-bottom: 1.5rem;
            padding-bottom: 0.5rem;
        }
         #playbook-sec-0-content .playbook-content-title .emoji {
            margin-right: 0.5rem;
        }

        #playbook-sec-0-content h3 {
            font-family: var(--font-headings-portal);
            font-size: clamp(1.3rem, 2.8vw, 1.7rem);
            text-transform: uppercase;
            margin-top: 2rem;
            margin-bottom: 1rem;
            text-align: center;
        }
         #playbook-sec-0-content h3 .emoji {
            margin-right: 0.4rem;
        }
        #playbook-sec-0-content p {
            font-family: var(--font-primary-portal);
            text-align: justify;
            line-height: 1.7;
            margin-bottom: 1rem;
        }
        #playbook-sec-0-content .valores-list {
            list-style: none;
            padding-left: 0;
            margin-top: 1rem;
        }
        #playbook-sec-0-content .valores-list li {
            margin-bottom: 1rem;
            padding-left: 0.5rem;
            text-align: left;
            font-family: var(--font-primary-portal);
        }
        #playbook-sec-0-content .valores-list .emoji {
            margin-right: 0.5rem;
            font-size: 1.1em;
        }


        @media (max-width: 768px) {
            html { font-size: 15px; }
            .capa-section { padding: clamp(1.5rem, 6vw, 3rem) clamp(0.8rem, 4vw, 1.5rem); }
            .capa-title { font-size: clamp(1.6rem, 4vw, 2.4rem); }
            .frase-destaque { font-size: clamp(0.9rem, 2vw, 1.1rem); }
            .logos-container { flex-direction: column; gap: 1rem; }
            .playbook-logo { width: 140px; }
            .global-header { padding: 0.8rem 1rem;}
            .header-logo { font-size: 1.15rem;}
            .dark-toggle, .voice-toggle { padding: 0.5rem;}
            .dark-toggle svg, .voice-toggle svg { width: 1.1rem; height: 1.1rem;}
            #portal-cards-section .page-title { font-size: clamp(1.8rem, 4vw, 2.4rem);}
            #portal-cards-section .page-subtitle { font-size: 1rem;}
            .section-title-main { font-size: clamp(1.5rem, 3.2vw, 2rem);}
            .portal-card-icon { font-size: 3rem; }
            .portal-card-title {font-size: 1.2rem;}
            .portal-card-description {font-size: 0.8rem;}
            .index-item-emoji { font-size: 2.2rem; }
            .index-item-title {font-size: 0.95rem;}
            .index-item-sub {font-size: 0.7rem;}
            .card-icon-wrapper { width: 5rem; height: 5rem; }
            .card-icon-wrapper i { font-size: 2.5rem; }
            .training-card .card-title {font-size: 1.2rem;}
            #playbook-sec-0-content .playbook-content-title { font-size: clamp(1.5rem, 3vw, 2rem); }
            #playbook-sec-0-content h3 { font-size: clamp(1.1rem, 2.5vw, 1.5rem); }
             #ai-tool-interaction-section .ai-tool-title { font-size: clamp(1.4rem, 3vw, 2rem); }
        }
         @media (max-width: 480px) {
            .playbook-logo { width: 110px; }
            .btn-iniciar { font-size: 0.9rem; padding: 0.6em 1.3em; }
            .capa-title { font-size: clamp(1.4rem, 4vw, 1.8rem); line-height: 1.25;}
            .frase-destaque { font-size: clamp(0.8rem, 1.8vw, 1rem); }
            .portal-card-icon { font-size: 2.5rem;}
            .portal-card-title {font-size: 1.1rem;}
            .index-item-emoji { font-size: 2rem; }
            .card-icon-wrapper { width: 4.5rem; height: 4.5rem; }
            .card-icon-wrapper i { font-size: 2.2rem; }
            .training-card .card-title {font-size: 1.05rem;}
            .header-logo { font-size: 1rem;}
            .global-header .flex > .dark-toggle { margin-left: 0.5rem;} 
         }

    </style>
</head>
<body>
    <header id="main-portal-header" class="global-header hidden">
        <div class="container mx-auto flex items-center justify-between">
            <div class="header-logo">
                <span class="title-autoarremate-part">Auto Arremate®</span><span class="title-arremaq-part"> / Arremaq</span>
            </div>
            <div class="flex items-center gap-3">
                <button id="voiceToggle" class="voice-toggle" aria-label="Ativar Comandos de Voz">
                    <i class="fas fa-microphone"></i>
                </button>
                <button id="themeTogglePortal" class="dark-toggle" aria-label="Alternar Modo Escuro">
                    <svg id="moonIconPortal" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M21.752 15.002A9.718 9.718 0 0118 15.75c-5.385 0-9.75-4.365-9.75-9.75 0-1.33.266-2.597.748-3.752A9.753 9.753 0 003 11.25C3 16.635 7.365 21 12.75 21c3.73 0 7.01-1.977 8.647-4.998z" /></svg>
                    <svg id="sunIconPortal" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" style="display:none;"><path stroke-linecap="round" stroke-linejoin="round" d="M12 3v2.25m6.364.386l-1.591 1.591M21 12h-2.25m-.386 6.364l-1.591-1.591M12 18.75V21m-6.364-.386l1.591-1.591M3 12h2.25m.386-6.364l1.591 1.591M12 6.75A5.25 5.25 0 006.75 12a5.25 5.25 0 005.25 5.25 5.25 5.25 0 005.25-5.25A5.25 5.25 0 0012 6.75z" /></svg>
                </button>
            </div>
        </div>
    </header>

    <main>
        <section id="capa-section" class="capa-section" data-aos="fade-in" data-aos-duration="1000">
            <div class="logos-container">
                <img src="https://www.autoarremate.com.br/wp-content/uploads/2022/09/logo-horizontal-padrao.svg" alt="Logotipo da Auto Arremate" class="playbook-logo" data-aos="zoom-in" data-aos-delay="200" onerror="this.onerror=null; this.src='https://placehold.co/180x50/ffffff/16B097?text=Auto+Arremate&font=ibmplexsans';">
                <img src="https://www.arremaq.com.br/wp-content/uploads/2021/01/Logotipo-Arremaqsuperbid.png" alt="Logotipo da Arremaq" class="playbook-logo" data-aos="zoom-in" data-aos-delay="300" onerror="this.onerror=null; this.src='https://placehold.co/180x50/ffffff/FF8C00?text=Arremaq&font=ibmplexsans';">
            </div>
            <h1 class="capa-title" data-aos="fade-up" data-aos-delay="400">
                Playbook Comercial e Central de Treinamentos
                <span class="title-autoarremate-part">3.0 Auto Arremate</span> /
                <span class="title-arremaq-part">Arremaq</span>
                <span class="year-highlight title-autoarremate-part">2025</span><sup class="title-autoarremate-part">®</sup>
            </h1>
            <p class="frase-destaque" data-aos="fade-up" data-aos-delay="600">🚦 ACELERA QUEM PODE, FREIA QUEM TEM JUÍZO 🛑</p>
            <p class="capa-criado" data-aos="fade-up" data-aos-delay="800">Criado pelo Analista de Operações <strong>Marcelo do Nascimento</strong></p>
            <button id="btnIniciarCapa" class="btn-iniciar" data-aos="fade-up" data-aos-delay="900">
                Iniciar Jornada
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M12.75 15l3-3m0 0l-3-3m3 3h-7.5M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                </svg>
            </button>
            <div class="capa-social-links" data-aos="fade-up" data-aos-delay="1000">
                <a href="https://facebook.com/auto-arremate" target="_blank" aria-label="Facebook Auto Arremate"><i class="fab fa-facebook-f"></i></a>
                <a href="https://www.instagram.com/autoarremate/" target="_blank" aria-label="Instagram Auto Arremate"><i class="fab fa-instagram"></i></a>
                <a href="https://www.linkedin.com/company/autoarremate/" target="_blank" aria-label="LinkedIn Auto Arremate"><i class="fab fa-linkedin-in"></i></a>
                <a href="https://wa.me/5511940366065" target="_blank" aria-label="WhatsApp Auto Arremate"><i class="fab fa-whatsapp"></i></a>
                <a href="tel:01640421197" aria-label="Telefone Auto Arremate"><i class="fas fa-phone"></i></a>
            </div>
        </section>

        <section id="portal-cards-section" class="hidden text-center py-8 md:py-10" data-aos="fade-up">
            <div class="container mx-auto px-4 sm:px-6 lg:px-8">
                <h1 class="page-title">
                    Portal <span class="title-autoarremate-part">Auto Arremate®</span> <span class="title-arremaq-part">/ Arremaq 3.0</span>
                </h1>
                <p class="page-subtitle mx-auto">
                    Seu acesso de elite ao conhecimento e ferramentas para vendas automotivas de alta performance.
                </p>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8 md:gap-10 lg:gap-12 max-w-3xl mx-auto">
                    <div id="openPlaybookBtn" class="portal-card" data-aos="fade-right" data-aos-delay="100">
                        <i class="fas fa-book-reader portal-card-icon"></i>
                        <h2 class="portal-card-title">Playbook Comercial</h2>
                        <p class="portal-card-description">Acesse o índice detalhado e navegue pelos capítulos do nosso playbook.</p>
                    </div>
                    <div id="openTrainingCenterBtn" class="portal-card" data-aos="fade-left" data-aos-delay="200">
                        <i class="fas fa-graduation-cap portal-card-icon"></i>
                        <h2 class="portal-card-title">Central de Treinamento IA</h2>
                        <p class="portal-card-description">Explore ferramentas de IA interativas para aprimorar suas habilidades.</p>
                    </div>
                </div>
                <button id="backToCoverBtn" class="btn-back btn-back-to-cover mt-12">
                    <i class="fas fa-arrow-left"></i> Voltar à Capa
                </button>
            </div>
        </section>

        <section id="playbook-content-section" class="hidden mt-0 md:mt-0 py-8 md:py-10" data-aos="fade-in">
            <div class="container mx-auto px-4 sm:px-6 lg:px-8">
                <button id="backToPortalFromPlaybook" class="btn-back mb-6">
                    <i class="fas fa-arrow-left"></i> Voltar ao Portal
                </button>
                <h2 class="section-title-main text-center">
                    <i class="fas fa-book-reader"></i>Playbook Comercial
                </h2>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 md:gap-8">
                    </div>
            </div>
        </section>

        <section id="playbook-sec-0-content" class="hidden mt-0 md:mt-0 py-8 md:py-10" data-aos="fade-in">
            <div class="container mx-auto px-4 sm:px-6 lg:px-8">
                <button id="backToPlaybookIndexFromSec0" class="btn-back mb-6">
                    <i class="fas fa-arrow-left"></i> Voltar ao Índice do Playbook
                </button>

                <section id="sec-0" data-aos="fade-up" data-aos-offset="150" class="playbook-inner-content p-6 md:p-8 rounded-lg shadow-lg">
                    <h2 class="playbook-content-title">
                        <span class="emoji">📍</span> <strong style="text-transform: uppercase;"><u>NOSSA ESSÊNCIA: HISTÓRIA E VALORES QUE NOS MOVEM!</u></strong>
                    </h2>
                    <div style="margin-bottom: 1.5rem;"></div>
                    <h3 id="sec-0-1">
                        <span class="emoji">🏢</span> <strong style="text-transform: uppercase;"><u>UMA EMPRESA DO GRUPO SUPERBID: GIGANTE POR NATUREZA!</u></strong>
                    </h3>
                    <img src="https://www.autoarremate.com.br/wp-content/uploads/2022/09/logo-grupo-superbid.svg" alt="Logotipo do Grupo Superbid" style="display: block; margin-left: auto; margin-right: auto; max-width: 200px; margin-bottom: 15px; border-radius: 8px;" onerror="this.onerror=null; this.src='https://placehold.co/200x60/ffffff/1C2E42?text=Grupo+Superbid&font=inter';">
                    <div style="margin-bottom: 1rem;"></div>
                    <p><span class="emoji">🎯</span> Nascemos fortes! Fazemos parte do <strong>Grupo Superbid</strong>, fundado em 1999 e pioneiro absoluto em leilões online na América Latina. Essa base sólida dá-nos perícia, credibilidade e acesso a um ecossistema gigantesco de compradores e vendedores.</p>
                    <div style="margin-bottom: 1rem;"></div>
                    <p><span class="emoji">📌</span> Herdamos a visão de transformar mercados complexos através da tecnologia, conectando compradores e vendedores de forma eficiente, transparente e segura.</p>
                    <div style="margin-bottom: 1.5rem;"></div>
                    <h3 id="sec-0-2">
                        <span class="emoji">💡</span> <strong style="text-transform: uppercase;"><u> IMPULSIONADOS PELA ACTION LABS: INOVAÇÃO NO DNA!</u></strong><span class="emoji">⚙️</span>
                    </h3>
                    <img src="https://www.autoarremate.com.br/wp-content/uploads/2022/12/logo-actionlabs.svg" alt="Logotipo da Action Labs" style="display: block; margin-left: auto; margin-right: auto; max-width: 200px; margin-bottom: 15px; border-radius: 8px;" onerror="this.onerror=null; this.src='https://placehold.co/200x60/ffffff/1C2E42?text=Action+Labs&font=inter';">
                    <div style="margin-bottom: 1rem;"></div>
                    <p><span class="emoji">⚙️</span> A nossa agilidade e capacidade de inovação têm um padrinho de peso: a <strong>Action Labs</strong>, o laboratório de inovação do Grupo Superbid. É daqui que saem as ideias disruptivas e as soluções tecnológicas que nos colocam sempre à frente.</p>
                    <div style="margin-bottom: 1rem;"></div>
                    <p><span class="emoji">🚀</span> Somos movidos pela busca constante de novas formas de otimizar processos, gerar valor e entregar a melhor experiência para os nossos clientes.</p>
                    <div style="margin-bottom: 1.5rem;"></div>
                    <h3 id="sec-0-3">
                        <span class="emoji">💖</span> <strong style="text-transform: uppercase;"><u>NOSSOS VALORES CORPORATIVOS: O CORAÇÃO DA AUTO ARREMATE®!</u></strong>
                    </h3>
                    <div style="margin-bottom: 1rem;"></div>
                    <p><span class="emoji">✍️</span> Tudo o que fazemos é guiado por valores sólidos, aplicados em cada interação com os nossos fornecedores, clientes e colaboradores. Eles são a bússola que nos direciona:</p>
                    <div style="margin-bottom: 1rem;"></div>
                    <ul class="valores-list">
                        <li><span class="emoji">🎯</span> <strong style="text-transform: uppercase;">FOCO NO CLIENTE:</strong><span class="emoji">🎉</span> Entendemos as suas demandas a fundo e entregamos soluções que superam expectativas.</li>
                        <div style="margin-bottom: 0.5rem;"></div>
                        <li><span class="emoji">🤝</span> <strong style="text-transform: uppercase;">ÉTICA E TRANSPARÊNCIA RADICAL:</strong><span class="emoji">▶️</span> Promovemos negócios e construímos relações baseadas na confiança mútua e clareza total.</li>
                        <div style="margin-bottom: 0.5rem;"></div>
                        <li><span class="emoji">🚀</span> <strong style="text-transform: uppercase;">OUSADIA PARA CRIAR E EMPREENDER:</strong><span class="emoji">🧐</span> Temos <strong>coragem</strong> para desbravar o novo, desafiar o status quo e buscar crescimento exponencial.</li>
                        <div style="margin-bottom: 0.5rem;"></div>
                        <li><span class="emoji">✨</span> <strong style="text-transform: uppercase;">INOVAÇÃO CONSTANTE:</strong><span class="emoji">📈</span> Somos curiosos e inquietos! Buscamos incessantemente por tecnologias e processos que otimizem resultados.</li>
                        <div style="margin-bottom: 0.5rem;"></div>
                        <li><span class="emoji">🌳</span> <strong style="text-transform: uppercase;">SUSTENTABILIDADE CONSCIENTE:</strong><span class="emoji">🏁</span> Geramos valor de forma <strong>sustentável</strong>, pensando no impacto social e ambiental das nossas ações.</li>
                        <div style="margin-bottom: 0.5rem;"></div>
                        <li><span class="emoji">⚙️</span> <strong style="text-transform: uppercase;">EXCELÊNCIA OPERACIONAL IMBATÍVEL:</strong><span class="emoji">🗺️</span> Estamos <strong>alinhados</strong> aos objetivos estratégicos, garantindo eficiência e qualidade superior em tudo que fazemos.</li>
                        <div style="margin-bottom: 0.5rem;"></div>
                        <li><span class="emoji">😊</span> <strong style="text-transform: uppercase;">VALORIZAÇÃO DAS PESSOAS:</strong><span class="emoji">💖</span> Acreditamos no poder da nossa equipa! Valorizamos e desenvolvemos os nossos talentos, criando um ambiente colaborativo e vencedor.</li>
                    </ul>
                </section>
            </div>
        </section>

        <section id="training-center-content-section" class="hidden mt-0 md:mt-0 py-8 md:py-10" data-aos="fade-in">
            <div class="container mx-auto px-4 sm:px-6 lg:px-8">
                <button id="backToPortalFromTraining" class="btn-back mb-6">
                    <i class="fas fa-arrow-left"></i> Voltar ao Portal Principal
                </button>
                <h2 class="section-title-main text-center">
                    <i class="fas fa-brain"></i>Central de Ferramentas de IA
                </h2>
                <div id="trainingCardsContainer" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-8 md:gap-10 lg:gap-12">
                    </div>
            </div>
        </section>

        <section id="ai-tool-interaction-section" class="hidden mt-0 md:mt-0 py-8 md:py-10" data-aos="fade-in">
            <div class="container mx-auto px-4 sm:px-6 lg:px-8 text-center">
                <button id="backToTrainingCenterFromTool" class="btn-back mb-6">
                    <i class="fas fa-arrow-left"></i> Voltar para Ferramentas de IA
                </button>
                <h2 id="aiToolTitle" class="ai-tool-title">Nome da Ferramenta de IA</h2>
                <p id="aiToolDescription" class="ai-tool-description mb-6">Descrição da ferramenta.</p>

                <div id="aiToolInputFieldsContainer" class="max-w-xl mx-auto space-y-4 mb-6">
                    </div>
                
                <div id="roleplayLogContainer" class="hidden max-w-xl mx-auto mb-6">
                    <h3 class="text-lg font-semibold mb-2 text-left" style="color: var(--text-headings-light-portal);">Log da Conversa:</h3>
                     <html[data-theme='dark'] #roleplayLogContainer h3 { color: var(--text-headings-dark-portal); }
                    <div id="roleplayLog" class="text-sm"></div>
                </div>
                
                <div class="flex flex-wrap justify-center gap-4 mt-4">
                    <button id="aiToolGenerateBtn" class="btn-iniciar btn-ai-action">
                        <i class="fas fa-magic-wand-sparkles mr-2"></i>Gerar com IA
                    </button>
                    <button id="aiToolRoleplaySendBtn" class="btn-iniciar btn-ai-action hidden">
                        <i class="fas fa-paper-plane mr-2"></i>Enviar Fala
                    </button>
                    <button id="aiToolRoleplayEvaluateBtn" class="btn-iniciar btn-ai-action bg-arremaq-orange hover:bg-arremaq-orange-darker hidden">
                        <i class="fas fa-award mr-2"></i>Finalizar e Avaliar
                    </button>
                    <button id="aiToolSaveBtn" class="btn-iniciar btn-ai-action bg-green-500 hover:bg-green-600" disabled>
                        <i class="fas fa-save mr-2"></i>Salvar Geração
                    </button>
                </div>
                <div id="saveFeedbackMessage" class="mt-2 text-sm"></div>


                <h3 class="text-xl font-semibold mt-8 mb-3" style="color: var(--text-headings-light-portal);">Resultado da IA:</h3>
                <html[data-theme='dark'] h3 { color: var(--text-headings-dark-portal); }
                <div id="aiToolOutput" class="max-w-2xl mx-auto">
                    Aguardando sua solicitação...
                </div>
            </div>
        </section>
    </main>

    <script type="module">
        // Importações do Firebase
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously, signInWithCustomToken, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, collection, addDoc, serverTimestamp, setLogLevel } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        // Configuração do Firebase (substitua com suas configurações reais se não usar __firebase_config)
        const firebaseConfigFromHost = typeof __firebase_config !== 'undefined' ? __firebase_config : null;
        const firebaseConfig = firebaseConfigFromHost ? JSON.parse(firebaseConfigFromHost) : {
            apiKey: "YOUR_FALLBACK_API_KEY", // Substitua se necessário
            authDomain: "YOUR_FALLBACK_AUTH_DOMAIN",
            projectId: "YOUR_FALLBACK_PROJECT_ID",
            storageBucket: "YOUR_FALLBACK_STORAGE_BUCKET",
            messagingSenderId: "YOUR_FALLBACK_MESSAGING_SENDER_ID",
            appId: "YOUR_FALLBACK_APP_ID"
        };

        // Inicialização do Firebase
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);
        setLogLevel('debug'); // Para logs detalhados do Firestore no console

        // Variáveis globais para o Firebase
        window.db = db;
        window.auth = auth;
        window.firebaseAddDoc = addDoc;
        window.firebaseCollection = collection;
        window.firebaseServerTimestamp = serverTimestamp;

        // Autenticação
        let currentUserId = null;
        onAuthStateChanged(auth, (user) => {
            if (user) {
                currentUserId = user.uid;
                console.log("Usuário autenticado:", currentUserId);
            } else {
                console.log("Nenhum usuário autenticado. Tentando login anônimo ou customizado.");
                // Tenta login com token customizado se disponível, senão anônimo
                if (typeof __initial_auth_token !== 'undefined' && __initial_auth_token) {
                    signInWithCustomToken(auth, __initial_auth_token)
                        .then((userCredential) => {
                            currentUserId = userCredential.user.uid;
                            console.log("Login com token customizado bem-sucedido:", currentUserId);
                        })
                        .catch((error) => {
                            console.error("Erro no login com token customizado, tentando anônimo:", error);
                            signInAnonymously(auth).catch(err => console.error("Erro no login anônimo:", err));
                        });
                } else {
                    signInAnonymously(auth).catch(err => console.error("Erro no login anônimo:", err));
                }
            }
             // Habilita/desabilita botão de salvar com base na autenticação e resultado da IA
            const saveBtn = document.getElementById('aiToolSaveBtn');
            if(saveBtn) saveBtn.disabled = !(currentUserId && document.getElementById('aiToolOutput')?.textContent !== 'Aguardando sua solicitação...' && !document.getElementById('aiToolOutput')?.textContent.toLowerCase().includes('erro'));
        });
        window.getCurrentUserId = () => currentUserId;


    </script>

    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    <script>
        // Variável global para armazenar dados da ferramenta de IA atualmente selecionada
        let currentAiToolData = null;
        let currentRoleplayConversation = []; 

        // Função para chamar a API Gemini
        async function callGeminiApi(prompt) {
            const apiKey = "AIzaSyBOA27Sl_hYO0q3bX7ON6KLcVJVcKsEonA"; 
            const model = "gemini-2.5-pro-preview"; 
            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/${model}:generateContent?key=${apiKey}`;

            const aiToolOutput = document.getElementById('aiToolOutput');
            const aiToolGenerateBtn = document.getElementById('aiToolGenerateBtn');
            const roleplaySendButton = document.getElementById('aiToolRoleplaySendBtn');
            const saveBtn = document.getElementById('aiToolSaveBtn');

            let originalButtonText = '';
            let currentButton = null;

            if (currentAiToolData && currentAiToolData.isRoleplayTool) {
                currentButton = roleplaySendButton;
            } else {
                currentButton = aiToolGenerateBtn;
            }
            
            if(currentButton) {
                originalButtonText = currentButton.innerHTML;
                currentButton.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i>Processando...';
                currentButton.disabled = true;
            }
            if(saveBtn) saveBtn.disabled = true; // Desabilita salvar enquanto gera
            aiToolOutput.textContent = 'Processando sua solicitação com a IA...';

            try {
                const payload = {
                    contents: [{ role: "user", parts: [{ text: prompt }] }]
                };
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                if (!response.ok) {
                    const errorData = await response.json();
                    console.error('Erro da API Gemini:', errorData);
                    throw new Error(`Erro da API: ${response.status} ${response.statusText}. Detalhes: ${JSON.stringify(errorData.error?.message || errorData)}`);
                }
                const result = await response.json();

                if (result.candidates && result.candidates.length > 0 &&
                    result.candidates[0].content && result.candidates[0].content.parts &&
                    result.candidates[0].content.parts.length > 0) {
                    const text = result.candidates[0].content.parts[0].text;
                    if(saveBtn && window.getCurrentUserId()) saveBtn.disabled = false; // Habilita salvar após sucesso
                    return text;
                } else {
                    console.error('Resposta inesperada da API Gemini:', result);
                    throw new Error('Não foi possível obter uma resposta válida da IA.');
                }
            } catch (error) {
                console.error('Falha ao chamar a API Gemini:', error);
                aiToolOutput.textContent = `Erro ao gerar resposta: ${error.message}. Verifique o console para mais detalhes.`;
                return null;
            } finally {
                 if(currentButton) {
                    currentButton.innerHTML = originalButtonText;
                    currentButton.disabled = false;
                 }
            }
        }


        document.addEventListener('DOMContentLoaded', function () {
            AOS.init({
                duration: 700,
                once: true,
                offset: 50
            });

            const htmlEl = document.documentElement;
            const mainPortalHeader = document.getElementById('main-portal-header');
            const themeTogglePortalBtn = document.getElementById('themeTogglePortal');
            const sunIconPortal = document.getElementById('sunIconPortal');
            const moonIconPortal = document.getElementById('moonIconPortal');
            const voiceToggleButton = document.getElementById('voiceToggle');
            let isDarkMode = false;

            function applyTheme(theme, manualToggle = false) {
                htmlEl.setAttribute('data-theme', theme);
                isDarkMode = theme === 'dark';
                if (sunIconPortal && moonIconPortal) {
                    sunIconPortal.style.display = isDarkMode ? 'block' : 'none';
                    moonIconPortal.style.display = isDarkMode ? 'none' : 'block';
                }
                if (manualToggle) {
                    try {
                        localStorage.setItem('theme', theme);
                    } catch (e) { console.warn("LocalStorage não disponível para salvar o tema."); }
                }
            }
            let currentTheme = localStorage.getItem('theme') || (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light');
            applyTheme(currentTheme);
            if (themeTogglePortalBtn) {
                themeTogglePortalBtn.addEventListener('click', () => {
                    applyTheme(htmlEl.getAttribute('data-theme') === 'dark' ? 'light' : 'dark', true);
                });
            }

            const capaSection = document.getElementById('capa-section');
            const portalCardsSection = document.getElementById('portal-cards-section');
            const playbookContentSection = document.getElementById('playbook-content-section');
            const trainingCenterContentSection = document.getElementById('training-center-content-section');
            const playbookSec0Content = document.getElementById('playbook-sec-0-content');
            const aiToolInteractionSection = document.getElementById('ai-tool-interaction-section');
            const trainingCardsContainer = document.getElementById('trainingCardsContainer');

            const btnIniciarCapa = document.getElementById('btnIniciarCapa');
            const openPlaybookBtn = document.getElementById('openPlaybookBtn');
            const openTrainingCenterBtn = document.getElementById('openTrainingCenterBtn');
            const backToCoverBtn = document.getElementById('backToCoverBtn');
            const backToPortalFromPlaybook = document.getElementById('backToPortalFromPlaybook');
            const backToPortalFromTraining = document.getElementById('backToPortalFromTraining');
            const backToPlaybookIndexFromSec0 = document.getElementById('backToPlaybookIndexFromSec0');
            const backToTrainingCenterFromTool = document.getElementById('backToTrainingCenterFromTool');

            const aiToolTitleEl = document.getElementById('aiToolTitle');
            const aiToolDescriptionEl = document.getElementById('aiToolDescription');
            const aiToolInputFieldsContainerEl = document.getElementById('aiToolInputFieldsContainer');
            const aiToolGenerateBtnEl = document.getElementById('aiToolGenerateBtn');
            const aiToolOutputEl = document.getElementById('aiToolOutput');
            const aiToolRoleplaySendBtnEl = document.getElementById('aiToolRoleplaySendBtn');
            const aiToolRoleplayEvaluateBtnEl = document.getElementById('aiToolRoleplayEvaluateBtn');
            const roleplayLogContainerEl = document.getElementById('roleplayLogContainer');
            const roleplayLogEl = document.getElementById('roleplayLog');
            const aiToolSaveBtnEl = document.getElementById('aiToolSaveBtn');
            const saveFeedbackMessageEl = document.getElementById('saveFeedbackMessage');


            const playbookItemsContainer = playbookContentSection.querySelector('.grid');
            const indexData = [
                { emoji: "📍", title: "NOSSA ESSÊNCIA, HISTÓRIA E VALORES", sub: "Propósito, cultura e jornada da Auto Arremate", href: "#sec-0", targetSectionId: "playbook-sec-0-content", sentenceEmoji: "🧭" },
                { emoji: "🚗", title: "BEM-VINDO(A) AO UNIVERSO AUTO ARREMATE", sub: "Panorama da plataforma, visão e diferenciais", href: "#sec-1", sentenceEmoji: "🌟" },
                { emoji: "🎯", title: "DESVENDANDO NOSSOS CLIENTES: ICPS & PERSONAS", sub: "Perfis ideais e personas para abordagem assertiva", href: "#sec-2", sentenceEmoji: "👤" },
                { emoji: "🧠", title: "QUALIFICAÇÃO NINJA", sub: "Técnicas de qualificação (SPIN, SNAP, AIDA)", href: "#sec-3", sentenceEmoji: "💡" },
                { emoji: "🛡️", title: "MATRIZ DE OBJEÇÕES", sub: "Como contornar objeções em cada etapa", href: "#sec-4", sentenceEmoji: "🗣️" },
                { emoji: "⚡", title: "FLUXOS DE PROSPECÇÃO", sub: "Roteiros, cadência e modelos de abordagem", href: "#sec-5", sentenceEmoji: "🌊" },
                { emoji: "📋", title: "VALIDAÇÃO B2B", sub: "Critérios para CNPJ, CNAEs de compradores", href: "#sec-6", sentenceEmoji: "✅" },
                { emoji: "✉️", title: "MODELOS DE COMUNICAÇÃO", sub: "Respostas padrão, termos e orientações legais", href: "#sec-7", sentenceEmoji: "✍️" },
                { emoji: "📖", title: "GLOSSÁRIO AUTOMOTIVO", sub: "Termos, conceitos e jargões do mercado", href: "#sec-8", sentenceEmoji: "📚" },
                { emoji: "🚀", title: "ROTEIRO DE EVOLUÇÃO E MELHORIA CONTÍNUA", sub: "Próximos passos para o playbook e equipe", href: "#sec-9-melhorias", sentenceEmoji: "📈" },
                { emoji: "📞", title: "CONTATO E SUPORTE", sub: "Canais de ajuda e informações da plataforma", href: "#sec-10-contato", sentenceEmoji: "🛠️" },
                { emoji: "🎮", title: "QUIZ GAMIFICADO", sub: "Teste seus conhecimentos sobre o Playbook!", href: "#quiz-gamificado-section", sentenceEmoji: "🏆" },
                { emoji: "🏁", title: "JOGO DE CORRIDA", sub: "Desafie-se na Corrida do Repasse!", href: "#corrida-svg-section", sentenceEmoji: "🏎️" }
            ];

            function populateIndexCards() {
                if (!playbookItemsContainer) return;
                playbookItemsContainer.innerHTML = '';
                indexData.forEach((item, idx) => {
                    const card = document.createElement('div');
                    card.className = 'index-item-card';
                    card.setAttribute('data-aos', 'fade-up');
                    card.setAttribute('data-aos-delay', (idx % 3) * 100);
                    const linkHref = item.targetSectionId ? `javascript:void(0);` : item.href;
                    const dataTargetAttr = item.targetSectionId ? `data-target="${item.targetSectionId}"` : '';
                    card.innerHTML = `
                        <a href="${linkHref}" ${dataTargetAttr} class="block w-full h-full">
                            <span class="index-item-emoji">${item.emoji}</span>
                            <h4 class="index-item-title">${item.title}</h4>
                            <p class="index-item-sub">
                                ${item.sentenceEmoji ? `<span class="sentence-emoji">${item.sentenceEmoji}</span>` : ''}
                                ${item.sub}
                            </p>
                        </a>`;
                    playbookItemsContainer.appendChild(card);
                });
            }

             const allTrainingData = [
                { toolId: "pitchAssistant", title: "✨ Assistente de Pitch com IA", description: "Crie pitches de vendas impactantes e personalizados. Insira detalhes do produto e público-alvo.", icon: "fa-microphone-alt", isAITool: true, aiPromptBase: "Você é um especialista em vendas. Crie um pitch de vendas conciso (máximo 3 parágrafos) e persuasivo para o produto/serviço '{field_productName}' direcionado ao público '{field_targetAudience}'. Destaque os 2-3 principais benefícios e diferenciais. Inclua uma chamada para ação clara e um gancho inicial forte.", inputFields: [{id: "productName", label: "Nome do Produto/Serviço:", type: "text", placeholder: "Ex: Software de Gestão Financeira Avançado"}, {id: "targetAudience", label: "Público-Alvo:", type: "text", placeholder: "Ex: Pequenas e Médias Empresas de tecnologia"}] },
                { toolId: "roleplayInteractive", title: "🗣️ Roleplay Interativo com IA (Beta)", description: "Simule conversas de vendas com uma IA e receba feedback. Defina o cenário e comece a interagir.", icon: "fa-comments", isAITool: true, aiPromptBase: "Vamos fazer um roleplay de vendas. O cenário é: {field_roleplayScenario}. Minha primeira fala como vendedor é: '{field_userUtterance}'. Responda como o cliente, sendo realista e apresentando possíveis objeções ou perguntas.", inputFields: [{id: "roleplayScenario", label: "Defina o Cenário do Roleplay:", type: "textarea", placeholder: "Ex: Sou um vendedor da Auto Arremate tentando vender nosso plano premium para um revendedor de carros usados que atualmente usa a concorrência."}, {id: "userUtterance", label: "Sua Fala Inicial (Vendedor):", type: "textarea", placeholder: "Digite sua primeira fala aqui..."}], isRoleplayTool: true },
                { toolId: "hubspotAutomationIdeas", title: "💡 Brainstorm de Workflows para HubSpot IA", description: "Receba ideias de workflows e automações para implementar no HubSpot e otimizar seu funil de vendas.", icon: "fa-cogs", isAITool: true, aiPromptBase: "Para uma empresa do setor '{field_companyIndustry}' que vende '{field_companyProduct}' para '{field_companyAudience}' e usa o HubSpot, sugira 3 ideias de workflows de automação detalhados (gatilho, ações, objetivo) para {field_hubspotGoal}. Seja específico nas ações dentro do HubSpot.", inputFields: [{id: "companyIndustry", label: "Setor da Empresa:", type: "text", placeholder: "Ex: Automotivo, Software SaaS"}, {id: "companyProduct", label: "Produto/Serviço Principal:", type: "text"}, {id: "companyAudience", label: "Público-Alvo Principal:", type: "text"}, {id: "hubspotGoal", label: "Objetivo da Automação no HubSpot:", type: "text", placeholder: "Ex: Nutrição de leads, Onboarding de clientes, Recuperação de carrinhos"}] },
                { toolId: "hubspotEmailSequencer", title: "✍️ Redator de E-mails para Sequências HubSpot IA", description: "Crie e-mails persuasivos para suas sequências de nutrição ou vendas no HubSpot.", icon: "fa-envelope-open-text", isAITool: true, aiPromptBase: "Crie uma sequência de {field_emailCount} e-mails para o HubSpot com o objetivo de {field_sequenceGoal}. O público é {field_emailAudience} e o produto/serviço é {field_emailProduct}. O primeiro e-mail deve ser um {field_firstEmailType}. Detalhe o assunto e corpo de cada e-mail.", inputFields: [{id: "emailCount", label: "Número de E-mails na Sequência:", type: "number", placeholder: "Ex: 3"}, {id: "sequenceGoal", label: "Objetivo da Sequência:", type: "text", placeholder: "Ex: Agendar uma demonstração"}, {id: "emailAudience", label: "Público do E-mail:", type: "text"}, {id: "emailProduct", label: "Produto/Serviço Ofertado:", type: "text"}, {id: "firstEmailType", label: "Tipo do Primeiro E-mail:", type: "text", placeholder: "Ex: Introdução e apresentação de valor"}] },
                { toolId: "coldCallScriptGenerator", title: "📝 Gerador de Script para Cold Call IA", description: "Crie scripts eficazes para o primeiro contato telefônico, focados em prender a atenção e qualificar.", icon: "fa-phone-volume", isAITool: true, aiPromptBase: "Desenvolva um script de cold call para apresentar o produto '{field_productColdCall}' para um potencial cliente do perfil '{field_prospectProfileColdCall}'. O script deve incluir: uma introdução rápida, uma pergunta de impacto para gerar interesse, breve apresentação do valor e um call-to-action para o próximo passo (ex: agendar reunião de 15 min).", inputFields: [{id: "productColdCall", label: "Produto/Serviço:", type: "text"}, {id: "prospectProfileColdCall", label: "Perfil do Prospect:", type: "text", placeholder: "Ex: Gerente de Compras de concessionária"}] },
                { toolId: "emailToneAnalyzer", title: "📧 Analisador de Tom de E-mail IA", description: "Cole um rascunho de e-mail e a IA analisará o tom (formal, amigável, persuasivo etc.) e dará sugestões.", icon: "fa-smile-wink", isAITool: true, aiPromptBase: "Analise o tom do seguinte e-mail e sugira melhorias para torná-lo mais {field_desiredTone}, considerando que o destinatário é {field_recipientContextEmail}. E-mail: '{field_emailDraft}'", inputFields: [{id: "emailDraft", label: "Rascunho do E-mail:", type: "textarea"}, {id: "desiredTone", label: "Tom Desejado:", type: "text", placeholder: "Ex: Profissional e Confiante"}, {id: "recipientContextEmail", label: "Contexto do Destinatário:", type: "text", placeholder: "Ex: Cliente antigo, Lead novo"}] },
                { toolId: "uspBuilder", title: "🚀 Criador de Argumentos de Venda Únicos (USP) IA", description: "Defina seu produto e concorrentes, e a IA ajudará a formular sua Proposta de Valor Única.", icon: "fa-rocket", isAITool: true, aiPromptBase: "Ajude-me a criar uma Proposta de Valor Única (USP) para meu produto '{field_myProductUSP}' que concorre com '{field_competitorUSP}'. Meu público-alvo é '{field_audienceUSP}'. Destaque o que o torna diferente e melhor.", inputFields: [{id: "myProductUSP", label: "Meu Produto/Serviço:", type: "text"}, {id: "competitorUSP", label: "Principal Concorrente:", type: "text"}, {id: "audienceUSP", label: "Público-Alvo:", type: "text"}] },
                { toolId: "customerPainIdentifier", title: "🎯 Identificador de Dores do Cliente IA", description: "Descreva seu cliente ideal e a IA listará possíveis dores e desafios que seu produto pode resolver.", icon: "fa-user-md", isAITool: true, aiPromptBase: "Para um cliente com o perfil '{field_clientProfilePain}', quais são as 3 principais dores ou desafios que ele provavelmente enfrenta e como o produto/serviço '{field_productSolutionPain}' poderia resolvê-los?", inputFields: [{id: "clientProfilePain", label: "Perfil do Cliente Ideal:", type: "textarea", placeholder: "Ex: Dono de pequena oficina mecânica com dificuldade em gerenciar estoque."}, {id: "productSolutionPain", label: "Seu Produto/Serviço:", type: "text"}] },
                { toolId: "powerfulQuestionsGenerator", title: "💡 Gerador de Perguntas Poderosas para Qualificação IA", description: "Receba sugestões de perguntas abertas e investigativas para qualificar leads.", icon: "fa-question", isAITool: true, aiPromptBase: "Gere 5 perguntas poderosas e abertas para um vendedor usar ao qualificar um lead interessado em '{field_productQualification}'. O objetivo é entender profundamente as necessidades e o potencial de compra do lead.", inputFields: [{id: "productQualification", label: "Produto/Serviço em Qualificação:", type: "text"}] },
                { toolId: "followUpStrategist", title: "🗓️ Estrategista de Follow-up IA", description: "Descreva a última interação com o lead e a IA sugerirá o próximo passo e o timing ideal para o follow-up.", icon: "fa-calendar-check", isAITool: true, aiPromptBase: "Após uma {field_lastInteractionType} sobre {field_interactionTopic} com um lead, onde ele mencionou {field_leadFeedback}, qual seria uma boa estratégia de follow-up (próximo passo, mensagem e timing ideal)?", inputFields: [{id: "lastInteractionType", label: "Tipo da Última Interação:", type: "text", placeholder: "Ex: Demonstração, Ligação inicial"}, {id: "interactionTopic", label: "Tópico da Interação:", type: "text"}, {id: "leadFeedback", label: "Feedback/Interesse do Lead:", type: "textarea"}] },
                { toolId: "linkedinProfileOptimizer", title: "🔗 Otimizador de Perfil LinkedIn IA", description: "Receba dicas para melhorar seu título, resumo e seções do LinkedIn para atrair mais conexões e oportunidades.", icon: "fab fa-linkedin", isAITool: true, aiPromptBase: "Analise este rascunho de resumo do LinkedIn para um profissional de vendas no setor '{field_linkedinIndustry}' que busca '{field_linkedinGoal}'. Forneça 3 sugestões para torná-lo mais atraente e otimizado para buscas. Resumo: '{field_linkedinSummary}'", inputFields: [{id: "linkedinIndustry", label: "Seu Setor:", type: "text"}, {id: "linkedinGoal", label: "Seu Objetivo no LinkedIn:", type: "text", placeholder: "Ex: Gerar leads, Construir autoridade"}, {id: "linkedinSummary", label: "Rascunho do seu Resumo/Sobre:", type: "textarea"}] },
                { toolId: "salesGoalSetter", title: "🏆 Definidor de Metas de Vendas SMART IA", description: "Transforme objetivos amplos em metas SMART (Específicas, Mensuráveis, Atingíveis, Relevantes, Temporais).", icon: "fa-bullseye", isAITool: true, aiPromptBase: "Meu objetivo de vendas é '{field_generalGoal}'. Ajude-me a transformar isso em 2-3 metas SMART, detalhando cada componente (Específico, Mensurável, Atingível, Relevante, Temporal).", inputFields: [{id: "generalGoal", label: "Objetivo Geral de Vendas:", type: "text", placeholder: "Ex: Aumentar as vendas no próximo trimestre"}] },
                { toolId: "marketTrendAnalyzer", title: "📊 Analisador de Tendências de Mercado IA", description: "Informe seu setor e a IA buscará (simuladamente) e resumirá tendências recentes relevantes.", icon: "fa-chart-bar", isAITool: true, aiPromptBase: "Quais são as 3 principais tendências de mercado atuais para o setor de '{field_industryTrend}' que um profissional de vendas deveria estar ciente? Forneça um breve resumo de cada uma.", inputFields: [{id: "industryTrend", label: "Seu Setor de Atuação:", type: "text"}] },
                { toolId: "meetingAgendaCreator", title: "📋 Criador de Pauta de Reunião IA", description: "Defina o objetivo da reunião e os participantes, e a IA montará uma sugestão de pauta.", icon: "fa-calendar-alt", isAITool: true, aiPromptBase: "Crie uma pauta para uma reunião de {field_meetingDurationMinutes} minutos sobre '{field_meetingMainTopic}'. Os participantes são '{field_meetingAttendees}' e o objetivo principal é '{field_meetingObjective}'.", inputFields: [{id: "meetingDurationMinutes", label: "Duração da Reunião (minutos):", type: "number"}, {id: "meetingMainTopic", label: "Tópico Principal:", type: "text"}, {id: "meetingAttendees", label: "Participantes (cargos/perfis):", type: "text"}, {id: "meetingObjective", label: "Objetivo Principal da Reunião:", type: "text"}] },
                { toolId: "elevatorPitchRefiner", title: "⏱️ Refinador de Elevator Pitch IA", description: "Apresente seu pitch de elevador e receba feedback para torná-lo mais conciso e impactante.", icon: "fa-stopwatch-20", isAITool: true, aiPromptBase: "Este é o meu elevator pitch: '{field_elevatorPitchDraft}'. Como posso torná-lo mais impactante e conciso (idealmente para ser dito em 30-60 segundos)?", inputFields: [{id: "elevatorPitchDraft", label: "Seu Rascunho de Elevator Pitch:", type: "textarea"}] },
                { toolId: "handlingPriceObjection", title: "💰 Especialista em Objeção de Preço IA", description: "Simule como responder especificamente à objeção 'é muito caro' para seu produto/serviço.", icon: "fa-dollar-sign", isAITool: true, aiPromptBase: "Um cliente diz que meu produto '{field_priceProduct}' é 'muito caro'. Considerando que os diferenciais são '{field_priceDiffs}', como posso responder de forma eficaz para justificar o valor?", inputFields: [{id: "priceProduct", label: "Produto/Serviço:", type: "text"}, {id: "priceDiffs", label: "Principais Diferenciais/Valor:", type: "textarea"}] },
                { toolId: "closingTechniqueSuggester", title: "🔑 Sugestor de Técnicas de Fechamento IA", description: "Descreva a situação da venda e a IA sugerirá técnicas de fechamento apropriadas.", icon: "fa-key", isAITool: true, aiPromptBase: "Estou em uma negociação para vender '{field_closingProduct}'. O cliente demonstrou interesse em '{field_clientInterestClosing}' mas está hesitante sobre '{field_clientHesitation}'. Quais técnicas de fechamento seriam mais adequadas?", inputFields: [{id: "closingProduct", label: "Produto/Serviço:", type: "text"}, {id: "clientInterestClosing", label: "Principal Interesse do Cliente:", type: "text"}, {id: "clientHesitation", label: "Ponto de Hesitação do Cliente:", type: "text"}] },
                { toolId: "postSaleMessageGenerator", title: "💌 Gerador de Mensagem Pós-Venda IA", description: "Crie mensagens de agradecimento e follow-up pós-venda para fortalecer o relacionamento.", icon: "fa-paper-plane", isAITool: true, aiPromptBase: "Gere uma mensagem de agradecimento e pós-venda para um cliente que acabou de adquirir '{field_productPurchased}'. O objetivo é {field_postSaleGoal}.", inputFields: [{id: "productPurchased", label: "Produto/Serviço Adquirido:", type: "text"}, {id: "postSaleGoal", label: "Objetivo da Mensagem Pós-Venda:", type: "text", placeholder: "Ex: Agradecer, pedir feedback, oferecer suporte"}] },
                { toolId: "timeManagementAdvisor", title: "⏳ Conselheiro de Gestão de Tempo IA", description: "Descreva suas tarefas e desafios de tempo, e a IA dará dicas de priorização e produtividade.", icon: "fa-hourglass-half", isAITool: true, aiPromptBase: "Minhas principais tarefas como vendedor são: {field_salesTasks}. Tenho dificuldade em {field_timeChallenge}. Quais são 3 dicas de gestão de tempo e priorização que podem me ajudar?", inputFields: [{id: "salesTasks", label: "Suas Principais Tarefas Diárias/Semanais:", type: "textarea"}, {id: "timeChallenge", label: "Seu Maior Desafio de Tempo:", type: "text", placeholder: "Ex: Lidar com muitas interrupções, procrastinação"}] },
                { toolId: "hubspotListSegmentationAdvisor", title: "📊 Consultor de Segmentação HubSpot IA", description: "Peça conselhos sobre como segmentar suas listas de contatos no HubSpot para campanhas mais eficazes.", icon: "fa-users-slash", isAITool: true, aiPromptBase: "Quero criar uma campanha de e-mail no HubSpot para promover '{field_hubspotCampaignProduct}'. Meus contatos têm informações sobre {field_hubspotContactProperties}. Como posso segmentar minha lista de forma eficaz para esta campanha? Sugira 2-3 critérios de segmentação.", inputFields: [{id: "hubspotCampaignProduct", label: "Produto/Serviço da Campanha:", type: "text"}, {id: "hubspotContactProperties", label: "Propriedades de Contato Disponíveis no HubSpot (ex: cargo, setor, última compra):", type: "textarea"}] },
                { toolId: "hubspotDealStageAdvisor", title: "🚦 Otimizador de Estágios de Negócio HubSpot IA", description: "Descreva seu funil de vendas e receba sugestões para otimizar os estágios de negócio no HubSpot.", icon: "fa-project-diagram", isAITool: true, aiPromptBase: "Meu funil de vendas atual tem os seguintes estágios: {field_currentDealStages}. Quero otimizar os estágios de negócio no HubSpot para melhor acompanhamento e previsão. Quais sugestões você daria, considerando que vendo {field_dealProductType}?", inputFields: [{id: "currentDealStages", label: "Estágios Atuais do Funil (separados por vírgula):", type: "text"}, {id: "dealProductType", label: "Tipo de Produto/Serviço Vendido:", type: "text"}] },
                { toolId: "competitorBattlecardCreator", title: "⚔️ Criador de Battlecard de Concorrente IA", description: "Informe um concorrente e seu produto, e a IA ajudará a montar um battlecard com pontos fortes, fracos e como vencê-los.", icon: "fa-shield-virus", isAITool: true, aiPromptBase: "Ajude-me a criar um battlecard para o concorrente '{field_competitorNameBattlecard}' que oferece '{field_competitorProductBattlecard}'. Meu produto é '{field_myProductBattlecard}'. Destaque os pontos fracos deles, meus pontos fortes comparativos e argumentos chave para usar contra eles.", inputFields: [{id: "competitorNameBattlecard", label: "Nome do Concorrente:", type: "text"},{id: "competitorProductBattlecard", label: "Produto/Serviço do Concorrente:", type: "text"}, {id: "myProductBattlecard", label: "Meu Produto/Serviço:", type: "text"}] },
                { toolId: "salesPresentationOutline", title: "🖥️ Esboçador de Apresentação de Vendas IA", description: "Defina o público e objetivo, e a IA criará um esboço para sua apresentação de vendas.", icon: "fa-person-chalkboard", isAITool: true, aiPromptBase: "Crie um esboço (principais slides/tópicos) para uma apresentação de vendas de {field_presentationMinutes} minutos sobre '{field_presentationProduct}' para '{field_presentationAudience}'. O objetivo é {field_presentationGoal}.", inputFields: [{id: "presentationMinutes", label: "Duração da Apresentação (minutos):", type: "number"},{id: "presentationProduct", label: "Produto/Serviço:", type: "text"},{id: "presentationAudience", label: "Público da Apresentação:", type: "text"},{id: "presentationGoal", label: "Objetivo da Apresentação:", type: "text"}] },
                { toolId: "networkingFollowUp", title: "🤝 Assistente de Follow-up Pós-Networking IA", description: "Conheceu alguém em um evento? A IA ajuda a redigir uma mensagem de follow-up eficaz.", icon: "fa-address-book", isAITool: true, aiPromptBase: "Conheci {field_contactNameNetworking} ({field_contactRoleNetworking}) em um {field_eventNetworking}. Conversamos sobre {field_conversationTopicNetworking}. Ajude-me a escrever uma mensagem de follow-up para o LinkedIn ou e-mail para fortalecer a conexão e explorar possíveis sinergias.", inputFields: [{id: "contactNameNetworking", label: "Nome do Contato:", type: "text"},{id: "contactRoleNetworking", label: "Cargo/Empresa do Contato:", type: "text"},{id: "eventNetworking", label: "Evento/Contexto:", type: "text"},{id: "conversationTopicNetworking", label: "Tópico da Conversa:", type: "text"}] },
                { toolId: "salesCadencePlanner", title: "⚡ Planejador de Cadência de Vendas IA", description: "Defina seu lead e objetivo, e a IA sugerirá uma cadência de contatos (e-mail, ligação, social) para engajá-lo.", icon: "fa-bolt", isAITool: true, aiPromptBase: "Sugira uma cadência de vendas de {field_cadenceDays} dias para um lead do tipo '{field_leadTypeCadence}' que demonstrou interesse inicial em '{field_productCadence}'. Inclua diferentes canais (e-mail, ligação, LinkedIn) e o objetivo de cada toque.", inputFields: [{id: "cadenceDays", label: "Duração da Cadência (dias):", type: "number", placeholder: "Ex: 7"},{id: "leadTypeCadence", label: "Tipo de Lead:", type: "text", placeholder: "Ex: MQL, SQL, Contato Frio"},{id: "productCadence", label: "Produto/Serviço:", type: "text"}] },
                { toolId: "customerSuccessStoryOutline", title: "🌟 Esboçador de Case de Sucesso IA", description: "Transforme um resultado positivo de cliente em um case de sucesso, com ajuda da IA para estruturar a história.", icon: "fa-award", isAITool: true, aiPromptBase: "Ajude-me a criar um esboço para um case de sucesso. O cliente é '{field_clientNameStory}', o desafio que ele enfrentava era '{field_clientChallengeStory}', a solução que oferecemos foi '{field_solutionStory}', e os resultados alcançados foram '{field_resultsStory}'. Quais seções devo incluir para contar essa história de forma impactante?", inputFields: [{id: "clientNameStory", label: "Nome do Cliente:", type: "text"},{id: "clientChallengeStory", label: "Desafio do Cliente:", type: "textarea"},{id: "solutionStory", label: "Solução Oferecida:", type: "textarea"},{id: "resultsStory", label: "Resultados Alcançados:", type: "textarea"}] },
                { toolId: "internalCommsGenerator", title: "📢 Gerador de Comunicados Internos de Vendas IA", description: "Precisa comunicar uma nova meta, produto ou processo para a equipe? A IA ajuda a redigir o comunicado.", icon: "fa-bullhorn", isAITool: true, aiPromptBase: "Crie um comunicado interno para a equipe de vendas sobre '{field_announcementTopic}'. O tom deve ser '{field_announcementTone}' e os pontos chave a serem comunicados são: {field_announcementKeyPoints}. Inclua um call to action se necessário.", inputFields: [{id: "announcementTopic", label: "Tópico do Comunicado:", type: "text", placeholder: "Ex: Nova Meta de Vendas Trimestral"},{id: "announcementTone", label: "Tom do Comunicado:", type: "text", placeholder: "Ex: Motivacional, Informativo"},{id: "announcementKeyPoints", label: "Pontos Chave (separados por vírgula):", type: "textarea"}] },
                { toolId: "salesTrainingRecap", title: "🧠 Recapitulador de Treinamento de Vendas IA", description: "Insira os tópicos de um treinamento e a IA criará um resumo com os pontos chave para revisão.", icon: "fa-book-reader", isAITool: true, aiPromptBase: "Crie um resumo conciso (bullet points) dos principais aprendizados de um treinamento de vendas que cobriu os seguintes tópicos: {field_trainingTopics}. O objetivo é facilitar a revisão pela equipe.", inputFields: [{id: "trainingTopics", label: "Tópicos Cobertos no Treinamento (separados por vírgula):", type: "textarea"}] },
                { toolId: "negotiationTacticsAdvisor", title: "♟️ Conselheiro de Táticas de Negociação IA", description: "Descreva um cenário de negociação e a IA sugerirá táticas e contra-argumentos.", icon: "fa-chess-knight", isAITool: true, aiPromptBase: "Estou negociando com {field_negotiationParty} sobre {field_negotiationSubject}. Eles estão pedindo {field_partyDemand}. Meu limite é {field_myLimit}. Que táticas de negociação posso usar e quais contra-argumentos seriam eficazes?", inputFields: [{id: "negotiationParty", label: "Com Quem Você Está Negociando:", type: "text"},{id: "negotiationSubject", label: "Assunto da Negociação:", type: "text"},{id: "partyDemand", label: "O Que a Outra Parte Está Pedindo:", type: "text"},{id: "myLimit", label: "Seu Limite/Condição:", type: "text"}] },
                { toolId: "linkedinLeadGenMessage", title: "💬 Gerador de Mensagem de Prospecção LinkedIn IA", description: "Crie mensagens personalizadas para iniciar conversas com leads no LinkedIn.", icon: "fab fa-linkedin-in", isAITool: true, aiPromptBase: "Escreva uma mensagem curta e personalizada para {field_leadNameLinkedIn} ({field_leadRoleLinkedIn} na {field_leadCompanyLinkedIn}) no LinkedIn. Vi que ele(a) {field_leadObservationLinkedIn}. Quero apresentar meu produto '{field_myProductLinkedIn}' que pode ajudar com {field_leadPainPointLinkedIn}. O objetivo é iniciar uma conversa.", inputFields: [{id: "leadNameLinkedIn", label: "Nome do Lead:", type: "text"},{id: "leadRoleLinkedIn", label: "Cargo do Lead:", type: "text"},{id: "leadCompanyLinkedIn", label: "Empresa do Lead:", type: "text"},{id: "leadObservationLinkedIn", label: "Algo que você observou no perfil dele(a):", type: "text"},{id: "myProductLinkedIn", label: "Seu Produto/Serviço:", type: "text"},{id: "leadPainPointLinkedIn", label: "Possível Dor/Necessidade do Lead:", type: "text"}]},
            ];


            function openAiToolInteraction(toolData) {
                currentAiToolData = toolData;
                currentRoleplayConversation = [];
                if(roleplayLogEl) roleplayLogEl.innerHTML = '';

                if(aiToolTitleEl) aiToolTitleEl.textContent = toolData.title;
                if(aiToolDescriptionEl) aiToolDescriptionEl.textContent = toolData.description;
                if(aiToolInputFieldsContainerEl) aiToolInputFieldsContainerEl.innerHTML = '';

                toolData.inputFields.forEach(field => {
                    const label = document.createElement('label');
                    label.className = 'input-field-label';
                    label.htmlFor = `aiToolInput_${field.id}`;
                    label.textContent = field.label;

                    let inputElement;
                    if (field.type === 'textarea') {
                        inputElement = document.createElement('textarea');
                        inputElement.rows = 3;
                    } else {
                        inputElement = document.createElement('input');
                        inputElement.type = field.type;
                    }
                    inputElement.className = 'input-field';
                    inputElement.id = `aiToolInput_${field.id}`;
                    inputElement.placeholder = field.placeholder || '';
                    if(aiToolInputFieldsContainerEl) {
                        aiToolInputFieldsContainerEl.appendChild(label);
                        aiToolInputFieldsContainerEl.appendChild(inputElement);
                    }
                });

                if(aiToolOutputEl) aiToolOutputEl.textContent = 'Aguardando sua solicitação...';
                if(aiToolSaveBtnEl) aiToolSaveBtnEl.disabled = true; // Desabilita salvar ao abrir nova ferramenta
                if(saveFeedbackMessageEl) saveFeedbackMessageEl.textContent = '';


                if (toolData.isRoleplayTool) {
                    if(aiToolGenerateBtnEl) aiToolGenerateBtnEl.classList.add('hidden');
                    if(aiToolRoleplaySendBtnEl) aiToolRoleplaySendBtnEl.classList.remove('hidden');
                    if(aiToolRoleplayEvaluateBtnEl) aiToolRoleplayEvaluateBtnEl.classList.remove('hidden');
                    if(roleplayLogContainerEl) roleplayLogContainerEl.classList.remove('hidden');
                } else {
                    if(aiToolGenerateBtnEl) aiToolGenerateBtnEl.classList.remove('hidden');
                    if(aiToolRoleplaySendBtnEl) aiToolRoleplaySendBtnEl.classList.add('hidden');
                    if(aiToolRoleplayEvaluateBtnEl) aiToolRoleplayEvaluateBtnEl.classList.add('hidden');
                    if(roleplayLogContainerEl) roleplayLogContainerEl.classList.add('hidden');
                }

                showTargetSection(aiToolInteractionSection);
                window.scrollTo({ top: 0, behavior: 'smooth' });
            }


            function populateTrainingCenterCards() {
                if (!trainingCardsContainer) return;
                trainingCardsContainer.innerHTML = '';

                allTrainingData.forEach((item, index) => {
                    const card = document.createElement('div');
                    card.className = 'training-card p-6 flex flex-col';
                    card.setAttribute('data-aos', 'fade-up');
                    card.setAttribute('data-aos-delay', ((index % 4) * 100) + 50);
                    if (item.isAITool) {
                        card.setAttribute('data-tool-id', item.toolId);
                        card.addEventListener('click', () => openAiToolInteraction(item));
                    }

                    const buttonHtml = item.isAITool ?
                        `<span class="card-button mt-auto pt-2">Abrir Ferramenta IA <i class="fas fa-arrow-right"></i></span>` :
                        `<a href="${item.link || '#'}" target="_blank" class="card-button mt-auto pt-2">
                            Acessar Módulo <i class="fas fa-arrow-right"></i>
                        </a>`;

                    card.innerHTML = `
                        <div class="card-icon-wrapper">
                            <i class="fas ${item.icon || 'fa-star'}"></i>
                        </div>
                        <h3 class="card-title">${item.title}</h3>
                        <p class="card-description">${item.description}</p>
                        ${buttonHtml}
                    `;
                    trainingCardsContainer.appendChild(card);
                });
                AOS.refreshHard();
            }

            if(aiToolGenerateBtnEl) {
                aiToolGenerateBtnEl.addEventListener('click', async () => {
                    if (!currentAiToolData) return;
                    if(saveFeedbackMessageEl) saveFeedbackMessageEl.textContent = '';


                    let prompt = currentAiToolData.aiPromptBase;
                    let allFieldsFilled = true;
                    currentAiToolData.inputFields.forEach(field => {
                        const inputElement = document.getElementById(`aiToolInput_${field.id}`);
                        if (inputElement && inputElement.value.trim()) {
                            prompt = prompt.replace(`{field_${field.id}}`, inputElement.value.trim());
                        } else {
                            allFieldsFilled = false;
                        }
                    });

                    if (!allFieldsFilled && currentAiToolData.inputFields.length > 0) {
                        aiToolOutputEl.textContent = "Por favor, preencha todos os campos para gerar o resultado.";
                        if(aiToolSaveBtnEl) aiToolSaveBtnEl.disabled = true;
                        return;
                    }
                    
                    const resultText = await callGeminiApi(prompt);
                    aiToolOutputEl.textContent = resultText || "Não foi possível gerar uma resposta.";
                    // Habilita salvar apenas se houver resultado e usuário logado
                    if(aiToolSaveBtnEl) aiToolSaveBtnEl.disabled = !(resultText && window.getCurrentUserId());
                });
            }

            if(aiToolRoleplaySendBtnEl) {
                aiToolRoleplaySendBtnEl.addEventListener('click', async () => {
                    if (!currentAiToolData || !currentAiToolData.isRoleplayTool) return;
                    if(saveFeedbackMessageEl) saveFeedbackMessageEl.textContent = '';


                    const scenarioField = currentAiToolData.inputFields.find(f => f.id === 'roleplayScenario');
                    const utteranceField = currentAiToolData.inputFields.find(f => f.id === 'userUtterance');

                    const scenarioInput = document.getElementById(`aiToolInput_${scenarioField.id}`);
                    const utteranceInput = document.getElementById(`aiToolInput_${utteranceField.id}`);

                    if (!scenarioInput || !utteranceInput || !scenarioInput.value.trim() || !utteranceInput.value.trim()) {
                        aiToolOutputEl.textContent = "Por favor, defina o cenário e digite sua fala para o roleplay.";
                         if(aiToolSaveBtnEl) aiToolSaveBtnEl.disabled = true;
                        return;
                    }
                    
                    const userUtterance = utteranceInput.value;
                    currentRoleplayConversation.push({speaker: "user", text: userUtterance});

                    let promptContext = `Cenário do Roleplay: ${scenarioInput.value}\n\nHistórico da Conversa (lembre-se de agir como o cliente respondendo ao vendedor):\n`;
                    currentRoleplayConversation.forEach(turn => { 
                        promptContext += `${turn.speaker === 'user' ? 'Vendedor' : 'Cliente (IA)'}: ${turn.text}\n`;
                    });
                    
                    let promptForApi = promptContext + `Cliente (IA):`; // A IA continua como Cliente


                    const aiResponseText = await callGeminiApi(promptForApi);

                    if (aiResponseText) {
                        currentRoleplayConversation.push({speaker: "ai", text: aiResponseText});
                        aiToolOutputEl.textContent = `Resposta da IA (Cliente):\n${aiResponseText}`;
                        utteranceInput.value = ""; 
                    } else {
                        aiToolOutputEl.textContent = "Não foi possível obter uma resposta da IA para o roleplay.";
                    }
                    updateRoleplayLog();
                    // Salvar para roleplay pode ser habilitado aqui ou após avaliação
                    if(aiToolSaveBtnEl) aiToolSaveBtnEl.disabled = !(currentRoleplayConversation.length > 0 && window.getCurrentUserId());
                });
            }

            if(aiToolRoleplayEvaluateBtnEl) {
                aiToolRoleplayEvaluateBtnEl.addEventListener('click', async () => {
                    if (currentRoleplayConversation.length === 0) {
                        aiToolOutputEl.textContent = "Nenhuma conversa de roleplay para avaliar. Interaja primeiro.";
                        if(aiToolSaveBtnEl) aiToolSaveBtnEl.disabled = true;
                        return;
                    }
                     if(saveFeedbackMessageEl) saveFeedbackMessageEl.textContent = '';


                    let conversationText = "Log da Conversa de Roleplay para Avaliação:\n\n";
                    currentRoleplayConversation.forEach(turn => {
                        conversationText += `${turn.speaker === 'user' ? 'Vendedor' : 'Cliente (IA)'}: ${turn.text}\n`;
                    });

                    const evaluationPrompt = `Como um coach de vendas experiente, por favor, avalie a performance do 'Vendedor' na seguinte conversa de roleplay. Considere os seguintes aspectos: clareza na comunicação, uso de perguntas eficazes, capacidade de identificar necessidades, contorno de objeções (se houver), persuasão, empatia, e eficácia em conduzir a conversa para um próximo passo positivo. Forneça feedback construtivo detalhado (pontos fortes e áreas de melhoria) e, se possível, uma pontuação geral de 0 a 10 para a performance do vendedor.\n\n${conversationText}`;
                    
                    const evaluationResult = await callGeminiApi(evaluationPrompt);
                    aiToolOutputEl.innerHTML = `--- AVALIAÇÃO DA IA ---<br><br>${evaluationResult || "Não foi possível gerar a avaliação."}`;
                    // Habilita salvar após avaliação
                     if(aiToolSaveBtnEl) aiToolSaveBtnEl.disabled = !(evaluationResult && window.getCurrentUserId());
                });
            }

            if(aiToolSaveBtnEl) {
                aiToolSaveBtnEl.addEventListener('click', async () => {
                    if (!currentAiToolData || !window.getCurrentUserId()) {
                        showSaveFeedback("Erro: Usuário não autenticado ou dados da ferramenta ausentes.", false);
                        return;
                    }
                    const generatedOutput = aiToolOutputEl.textContent;
                    if (!generatedOutput || generatedOutput === 'Aguardando sua solicitação...' || generatedOutput.toLowerCase().includes('erro')) {
                        showSaveFeedback("Nenhum resultado válido para salvar.", false);
                        return;
                    }

                    const inputsToSave = {};
                    currentAiToolData.inputFields.forEach(field => {
                        const inputElement = document.getElementById(`aiToolInput_${field.id}`);
                        if (inputElement) {
                            inputsToSave[field.id] = inputElement.value;
                        }
                    });
                    // Para roleplay, salvar o log da conversa e o cenário também
                    if (currentAiToolData.isRoleplayTool) {
                        inputsToSave.roleplayConversationLog = currentRoleplayConversation;
                    }


                    const generationToSave = {
                        userId: window.getCurrentUserId(),
                        toolId: currentAiToolData.toolId,
                        toolTitle: currentAiToolData.title,
                        inputs: inputsToSave,
                        output: generatedOutput,
                        savedAt: window.firebaseServerTimestamp() 
                    };

                    try {
                        const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';
                        const docRef = await window.firebaseAddDoc(window.firebaseCollection(window.db, `artifacts/${appId}/users/${window.getCurrentUserId()}/ai_generations`), generationToSave);
                        console.log("Geração salva com ID: ", docRef.id);
                        showSaveFeedback("Geração salva com sucesso!", true);
                    } catch (e) {
                        console.error("Erro ao salvar geração: ", e);
                        showSaveFeedback("Falha ao salvar. Tente novamente.", false);
                    }
                });
            }

            function showSaveFeedback(message, isSuccess) {
                if (!saveFeedbackMessageEl) return;
                saveFeedbackMessageEl.textContent = message;
                saveFeedbackMessageEl.className = isSuccess ? 'feedback-success' : 'feedback-error';
                setTimeout(() => {
                    saveFeedbackMessageEl.textContent = '';
                }, 3000);
            }


            function updateRoleplayLog() {
                if(!roleplayLogEl) return;
                roleplayLogEl.innerHTML = '';
                currentRoleplayConversation.forEach(turn => {
                    const turnDiv = document.createElement('div');
                    turnDiv.classList.add(turn.speaker === 'user' ? 'user-message' : 'ai-message');
                    turnDiv.textContent = `${turn.speaker === 'user' ? 'Você (Vendedor)' : 'Cliente (IA)'}: ${turn.text}`;
                    roleplayLogEl.appendChild(turnDiv);
                });
                roleplayLogEl.scrollTop = roleplayLogEl.scrollHeight;
            }


            const allPageSections = [
                capaSection, portalCardsSection, playbookContentSection,
                trainingCenterContentSection, playbookSec0Content, aiToolInteractionSection
            ];

            function showTargetSection(sectionToShow) {
                allPageSections.forEach(section => {
                    if (section && section !== sectionToShow) section.classList.add('hidden');
                });
                if (sectionToShow === capaSection) {
                    if (mainPortalHeader) mainPortalHeader.classList.add('hidden');
                } else {
                    if (mainPortalHeader) mainPortalHeader.classList.remove('hidden');
                }
                if (sectionToShow) {
                    sectionToShow.classList.remove('hidden');
                    setTimeout(() => { AOS.refreshHard(); }, 50);
                }
            }

            function showCoverPage() { showTargetSection(capaSection); }
            function showPortalCards() { showTargetSection(portalCardsSection); }
            function showPlaybookIndex() { populateIndexCards(); showTargetSection(playbookContentSection); }
            function showTrainingCenter() { populateTrainingCenterCards(); showTargetSection(trainingCenterContentSection); }

            if (btnIniciarCapa) btnIniciarCapa.addEventListener('click', (e) => { e.preventDefault(); showPortalCards(); window.scrollTo({ top: 0, behavior: 'smooth' }); });
            if (openPlaybookBtn) openPlaybookBtn.addEventListener('click', () => { showPlaybookIndex(); window.scrollTo({ top: 0, behavior: 'smooth' }); });
            if (openTrainingCenterBtn) openTrainingCenterBtn.addEventListener('click', () => { showTrainingCenter(); window.scrollTo({ top: 0, behavior: 'smooth' }); });
            if (backToCoverBtn) backToCoverBtn.addEventListener('click', () => { showCoverPage(); window.scrollTo({ top: 0, behavior: 'smooth' }); });
            if (backToPortalFromPlaybook) backToPortalFromPlaybook.addEventListener('click', () => { showPortalCards(); window.scrollTo({ top: 0, behavior: 'smooth' }); });
            if (backToPortalFromTraining) backToPortalFromTraining.addEventListener('click', () => { showPortalCards(); window.scrollTo({ top: 0, behavior: 'smooth' }); });
            if (backToPlaybookIndexFromSec0) backToPlaybookIndexFromSec0.addEventListener('click', () => { showPlaybookIndex(); window.scrollTo({ top: 0, behavior: 'smooth' }); });
            if (backToTrainingCenterFromTool) backToTrainingCenterFromTool.addEventListener('click', () => { showTrainingCenter(); window.scrollTo({ top: 0, behavior: 'smooth' }); });

            if (playbookItemsContainer) {
                playbookItemsContainer.addEventListener('click', function(event) {
                    let targetLink = event.target.closest('a[data-target]');
                    if (targetLink) {
                        event.preventDefault();
                        const sectionIdToShow = targetLink.dataset.target;
                        const targetSectionElement = document.getElementById(sectionIdToShow);
                        if (targetSectionElement) {
                            showTargetSection(targetSectionElement);
                            window.scrollTo({ top: 0, behavior: 'smooth' });
                        }
                    }
                });
            }
            showCoverPage();


            // --- Lógica de Comando de Voz ---
            const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
            let recognition;

            if (SpeechRecognition && voiceToggleButton) {
                recognition = new SpeechRecognition();
                recognition.continuous = false;
                recognition.lang = 'pt-BR';
                recognition.interimResults = false;
                recognition.maxAlternatives = 1;

                voiceToggleButton.addEventListener('click', () => {
                    if (recognition && !voiceToggleButton.classList.contains('listening')) {
                        try {
                            recognition.start();
                        } catch (e) {
                            console.error("Erro ao iniciar reconhecimento de voz (provavelmente já iniciado ou permissão negada):", e);
                            voiceToggleButton.classList.remove('listening');
                            if(voiceToggleButton.querySelector('i')) voiceToggleButton.querySelector('i').className = 'fas fa-microphone';
                        }
                    } else if (recognition) {
                        recognition.stop();
                    }
                });
                
                recognition.onstart = () => {
                    voiceToggleButton.classList.add('listening');
                    if(voiceToggleButton.querySelector('i')) voiceToggleButton.querySelector('i').className = 'fas fa-microphone-alt fa-beat';
                    console.log("Reconhecimento de voz iniciado.");
                };

                recognition.onresult = (event) => {
                    const command = event.results[event.results.length - 1][0].transcript.trim().toLowerCase();
                    console.log('Comando recebido:', command);
                    processVoiceCommand(command);
                };

                recognition.onerror = (event) => {
                    console.error('Erro no reconhecimento de voz:', event.error);
                    let userMessage = "Ocorreu um erro com o reconhecimento de voz.";
                    if (event.error === 'no-speech') {
                        userMessage = "Nenhuma fala detectada. Tente novamente.";
                    } else if (event.error === 'audio-capture') {
                        userMessage = "Problema na captura de áudio. Verifique seu microfone.";
                    } else if (event.error === 'not-allowed') {
                        userMessage = "Permissão para usar o microfone negada ou não concedida. Verifique as configurações do seu navegador.";
                    }
                    console.warn(userMessage); // Log para debug, não mostrar alert
                     voiceToggleButton.classList.remove('listening');
                     if(voiceToggleButton.querySelector('i')) voiceToggleButton.querySelector('i').className = 'fas fa-microphone';
                };
                
                recognition.onend = () => {
                    voiceToggleButton.classList.remove('listening');
                    if(voiceToggleButton.querySelector('i')) voiceToggleButton.querySelector('i').className = 'fas fa-microphone';
                    console.log("Reconhecimento de voz finalizado.");
                };

            } else {
                console.warn("API de Reconhecimento de Voz não suportada neste navegador ou botão de voz não encontrado.");
                if(voiceToggleButton) voiceToggleButton.style.display = 'none';
            }

            function processVoiceCommand(command) {
                if (command.includes("abrir central de treinamento") || command.includes("central de treinamento ia")) {
                    showTrainingCenter();
                } else if (command.includes("abrir playbook") || command.includes("abrir o playbook")) {
                    showPlaybookIndex();
                } else if (command.includes("voltar para o início") || command.includes("ir para capa") || command.includes("voltar para o inicio") || command.includes("ir para a capa")) {
                    showCoverPage();
                } else if (command.includes("voltar para o portal") || command.includes("portal principal")) {
                    showPortalCards();
                } else if (command.includes("modo escuro") || command.includes("alternar tema")) {
                    applyTheme(htmlEl.getAttribute('data-theme') === 'dark' ? 'light' : 'dark', true);
                } else if (command.includes("modo claro")) {
                    applyTheme('light', true);
                }
                else if (trainingCenterContentSection && !trainingCenterContentSection.classList.contains('hidden') && aiToolInteractionSection && aiToolInteractionSection.classList.contains('hidden')) {
                    if (command.startsWith("abrir ")) {
                        const toolNameToOpen = command.substring("abrir ".length).trim();
                        const toolToOpen = allTrainingData.find(tool => tool.title.toLowerCase().includes(toolNameToOpen));
                        if (toolToOpen) {
                            openAiToolInteraction(toolToOpen);
                        } else {
                            console.warn(`Ferramenta de IA "${toolNameToOpen}" não encontrada.`);
                            speakText(`Desculpe, não encontrei a ferramenta ${toolNameToOpen}.`);
                        }
                    }
                } else if (aiToolInteractionSection && !aiToolInteractionSection.classList.contains('hidden')) { 
                    if (command.includes("gerar resultado") || command.includes("gerar com ia")) {
                        if (currentAiToolData && !currentAiToolData.isRoleplayTool && aiToolGenerateBtnEl) {
                             aiToolGenerateBtnEl.click();
                        } else if (currentAiToolData && currentAiToolData.isRoleplayTool) {
                            console.log("Comando 'gerar' ignorado para ferramenta de roleplay. Use 'enviar fala'.");
                            speakText("Para o roleplay, use o comando 'enviar fala'.");
                        }
                    } else if (command.includes("enviar fala") && currentAiToolData && currentAiToolData.isRoleplayTool && aiToolRoleplaySendBtnEl) {
                        aiToolRoleplaySendBtnEl.click();
                    } else if (command.includes("avaliar roleplay") && currentAiToolData && currentAiToolData.isRoleplayTool && aiToolRoleplayEvaluateBtnEl) {
                        aiToolRoleplayEvaluateBtnEl.click();
                    } else if (command.includes("salvar geração") && aiToolSaveBtnEl && !aiToolSaveBtnEl.disabled) {
                        aiToolSaveBtnEl.click();
                    }
                     else if (command.includes("limpar campos")) {
                        if (currentAiToolData && currentAiToolData.inputFields) {
                            currentAiToolData.inputFields.forEach(field => {
                                const inputElement = document.getElementById(`aiToolInput_${field.id}`);
                                if (inputElement) inputElement.value = "";
                            });
                            if(currentAiToolData.isRoleplayTool) { 
                                currentRoleplayConversation = [];
                                updateRoleplayLog();
                            }
                            if(aiToolOutputEl) aiToolOutputEl.textContent = "Campos limpos.";
                            if(aiToolSaveBtnEl) aiToolSaveBtnEl.disabled = true;
                            if(saveFeedbackMessageEl) saveFeedbackMessageEl.textContent = '';
                        }
                    } else if (command.includes("ler resultado") && aiToolOutputEl) {
                        const textToRead = aiToolOutputEl.textContent;
                        if (textToRead && textToRead !== "Aguardando sua solicitação..." && !textToRead.toLowerCase().includes("erro")) {
                            speakText(textToRead);
                        } else {
                            speakText("Nenhum resultado para ler ou ocorreu um erro.");
                        }
                    } else if (command.includes("voltar para treinamentos") || command.includes("voltar para ferramentas")) {
                        showTrainingCenter();
                    }
                } else {
                    console.log("Comando não reconhecido ou não aplicável ao contexto atual:", command);
                }
            }

            function speakText(text) {
                if ('speechSynthesis' in window) {
                    speechSynthesis.cancel(); 
                    const utterance = new SpeechSynthesisUtterance(text);
                    utterance.lang = 'pt-BR';
                    speechSynthesis.speak(utterance);
                } else {
                    console.warn("API de Síntese de Voz não suportada neste navegador.");
                }
            }

        });
    </script>

</body>
</html>
